    :root {
      /* Typography Scale */
      --font-size-xs: 11px;
      --font-size-sm: 13px;
      --font-size-base: 15px;
      --font-size-lg: 18px;
      --font-size-xl: 22px;
      --font-size-2xl: 28px;
      --font-size-3xl: 36px;

      /* Font Weights */
      --font-weight-normal: 400;
      --font-weight-medium: 500;
      --font-weight-semibold: 600;
      --font-weight-bold: 700;

      /* Spacing Scale */
      --space-1: 4px;
      --space-2: 8px;
      --space-3: 12px;
      --space-4: 16px;
      --space-5: 20px;
      --space-6: 24px;
      --space-8: 32px;
      --space-10: 40px;

      /* Border Radius Scale */
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 14px;
      --radius-xl: 18px;

      /* Colors */
      --bg: #f7f8fc;
      --bg-gradient: radial-gradient(1200px 520px at 50% -240px, rgba(102, 126, 234, 0.16), rgba(247, 248, 252, 0) 65%),
        linear-gradient(180deg, #fdfdff 0%, #f7f8fc 100%);
      --card: #ffffff;
      --text: #1a1a2e;
      --muted: #6b7280;
      --accent: #667eea;
      --accent2: #6d5ce7;
      --accent-soft: rgba(102, 126, 234, 0.12);
      --accent-soft-strong: rgba(102, 126, 234, 0.18);
      --danger: #ef4444;
      --success: #10b981;
      --shadow: 0 2px 6px rgba(15, 23, 42, 0.08);
      --shadow-hover: 0 10px 24px rgba(15, 23, 42, 0.12);
      --border: #e6e8f0;
      --header-bg: rgba(255, 255, 255, 0.86);
      --font: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      --input-bg: #ffffff;
      --day-other: #f1f3f8;
      --day-hover: #eceff6;
      --btn-secondary-bg: #eef1f6;
      --btn-secondary-hover: #e2e6ef;
      --focus-ring: 0 0 0 3px rgba(102, 126, 234, 0.4);
    }

    body.dark {
      --bg: #0f172a;
      --bg-gradient: radial-gradient(1000px 480px at 50% -220px, rgba(99, 102, 241, 0.18), rgba(15, 23, 42, 0) 65%),
        linear-gradient(180deg, #0b1222 0%, #0f172a 100%);
      --card: #1e293b;
      --text: #f1f5f9;
      --muted: #94a3b8;
      --border: #334155;
      --accent-soft: rgba(129, 140, 248, 0.18);
      --accent-soft-strong: rgba(129, 140, 248, 0.28);
      --shadow: 0 6px 16px rgba(0, 0, 0, 0.35);
      --shadow-hover: 0 12px 28px rgba(0, 0, 0, 0.5);
      --input-bg: #1e293b;
      --day-other: #1a2535;
      --day-hover: #243146;
      --btn-secondary-bg: #2b394f;
      --btn-secondary-hover: #3a4b66;
      --header-bg: rgba(15, 23, 42, 0.82);
      --focus-ring: 0 0 0 3px rgba(102, 126, 234, 0.5);
    }

    /* Accessibility: Focus visible */
    :focus-visible {
      outline: none;
      box-shadow: var(--focus-ring);
    }

    .icon {
      font-family: "Material Symbols Rounded";
      font-style: normal;
      font-weight: 500;
      font-size: 20px;
      line-height: 1;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      vertical-align: middle;
      font-variation-settings: "FILL" var(--icon-fill, 0), "wght" 500, "GRAD" 0, "opsz" 24;
    }

    /* Reduced motion for users who prefer it */
    @media (prefers-reduced-motion: reduce) {

      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Priority Colors */
    .priority-urgent {
      --priority-color: #ef4444;
      --priority-bg: #fef2f2;
    }

    .priority-high {
      --priority-color: #f97316;
      --priority-bg: #fff7ed;
    }

    .priority-medium {
      --priority-color: #eab308;
      --priority-bg: #fefce8;
    }

    .priority-low {
      --priority-color: #22c55e;
      --priority-bg: #f0fdf4;
    }

    .priority-none {
      --priority-color: #6b7280;
      --priority-bg: var(--day-other);
    }

    body.dark .priority-urgent {
      --priority-bg: rgba(239, 68, 68, 0.15);
    }

    body.dark .priority-high {
      --priority-bg: rgba(249, 115, 22, 0.15);
    }

    body.dark .priority-medium {
      --priority-bg: rgba(234, 179, 8, 0.15);
    }

    body.dark .priority-low {
      --priority-bg: rgba(34, 197, 94, 0.15);
    }

    body.dark .priority-none {
      --priority-bg: var(--day-other);
    }

    /* Fixed Header Bar - Always on top */
    .fixed-header-bar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: var(--header-bg);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      padding: 0 16px;
      gap: 10px;
      z-index: 10000;
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px) saturate(1.1);
    }

    .header-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      opacity: 1;
      /* Changed from 0.3 to 1 */
      border: 1px solid transparent;
      border-radius: var(--radius-md);
      background: transparent;
      color: var(--muted);
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }

    .header-btn:hover {
      background: var(--day-hover);
      border-color: rgba(102, 126, 234, 0.2);
    }

    .header-btn.active {
      background: var(--accent-soft);
      color: var(--accent);
      border-color: rgba(102, 126, 234, 0.2);
    }

    .header-btn.icon-only {
      width: 38px;
      height: 38px;
      padding: 0;
      justify-content: center;
      border-radius: 12px;
      background: var(--day-other);
    }

    .header-btn .icon {
      font-size: 18px;
    }

    .header-btn.active .icon {
      --icon-fill: 1;
    }

    /* Notification button enabled state */
    #notifyBtn.notify-enabled {
      background: var(--accent-soft);
      border-color: rgba(102, 126, 234, 0.35);
      box-shadow: none;
    }

    .sync-badge {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--day-other);
      color: var(--muted);
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-medium);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-left: auto;
    }

    .sync-badge.hidden {
      display: none;
    }

    .sync-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
      animation: syncPulse 1.6s ease-in-out infinite;
    }

    @keyframes syncPulse {
      0% {
        transform: scale(0.9);
        opacity: 0.6;
      }

      50% {
        transform: scale(1.1);
        opacity: 1;
      }

      100% {
        transform: scale(0.9);
        opacity: 0.6;
      }
    }

    .header-spacer {
      flex: 1;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    /* PWA/Mobile Optimizations */
    html {
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      overscroll-behavior: none;
    }

    /* Safe area padding for notched phones */
    @supports (padding: env(safe-area-inset-top)) {
      body {
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
        padding-left: env(safe-area-inset-left);
        padding-right: env(safe-area-inset-right);
      }
    }


    /* Smoother touch scrolling */
    .app-layout,
    .sidebar,
    .task-list,
    .event-list {
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
    }

    /* Better touch targets */
    button,
    a,
    .clickable,
    [role="button"] {
      touch-action: manipulation;
    }

    /* Prevent text selection on interactive elements */
    button,
    .btn,
    .task-checkbox,
    .task-action-btn {
      -webkit-user-select: none;
      user-select: none;
    }

    /* ============ ENHANCED FEATURES CSS ============ */

    /* Command Palette */
    .command-palette-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
      z-index: 20000;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding-top: 15vh;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.15s, visibility 0.15s;
    }

    .command-palette-backdrop.open {
      opacity: 1;
      visibility: visible;
    }

    .command-palette {
      background: var(--card);
      border-radius: 16px;
      box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
      width: 90%;
      max-width: 560px;
      max-height: 70vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transform: translateY(-20px) scale(0.95);
      transition: transform 0.2s;
    }

    .command-palette-backdrop.open .command-palette {
      transform: translateY(0) scale(1);
    }

    .command-palette-input-wrap {
      padding: 16px;
      border-bottom: 1px solid var(--border);
    }

    .command-palette-input {
      width: 100%;
      padding: 14px 18px;
      border: 2px solid var(--border);
      border-radius: 12px;
      font-size: 16px;
      background: var(--input-bg);
      color: var(--text);
      outline: none;
    }

    .command-palette-input:focus {
      border-color: var(--accent);
    }

    .command-palette-results {
      flex: 1;
      overflow-y: auto;
      padding: 8px;
    }

    .command-palette-item {
      padding: 12px 16px;
      border-radius: 10px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: background 0.1s;
    }

    .command-palette-item:hover,
    .command-palette-item.selected {
      background: var(--day-hover);
    }

    .command-palette-item.selected {
      background: var(--accent);
      color: white;
    }

    .command-palette-icon {
      font-size: 20px;
      width: 32px;
      text-align: center;
    }

    .command-palette-label {
      flex: 1;
      font-size: 14px;
    }

    .command-palette-shortcut {
      font-size: 11px;
      color: var(--muted);
      background: var(--day-other);
      padding: 3px 8px;
      border-radius: 6px;
    }

    .command-palette-item.selected .command-palette-shortcut {
      background: rgba(255, 255, 255, 0.2);
      color: white;
    }

    .command-palette-empty {
      padding: 40px 16px;
      text-align: center;
      color: var(--muted);
    }

    .command-palette-section-title {
      padding: 8px 16px 4px;
      font-size: 11px;
      font-weight: 600;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Task Completion Confetti Animation */
    @keyframes confettiPop {
      0% {
        transform: scale(0) rotate(0deg);
        opacity: 1;
      }

      50% {
        transform: scale(1.2) rotate(180deg);
        opacity: 0.8;
      }

      100% {
        transform: scale(0) rotate(360deg) translateY(-100px);
        opacity: 0;
      }
    }

    @keyframes confettiFall {
      0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
      }

      100% {
        transform: translateY(150px) rotate(720deg);
        opacity: 0;
      }
    }

    .confetti-container {
      position: fixed;
      pointer-events: none;
      z-index: 30000;
    }

    .confetti-piece {
      position: absolute;
      width: 10px;
      height: 10px;
      border-radius: 2px;
      animation: confettiFall 1.2s ease-out forwards;
    }

    .task-item.completing {
      animation: taskCompleteFlash 0.4s ease-out;
    }

    @keyframes taskCompleteFlash {
      0% {
        background: var(--card);
      }

      50% {
        background: rgba(34, 197, 94, 0.2);
      }

      100% {
        background: var(--card);
      }
    }

    /* Pomodoro Progress Ring */
    .pomodoro-ring-container {
      position: relative;
      width: 200px;
      height: 200px;
      margin: 0 auto 20px;
    }

    .pomodoro-ring-svg {
      transform: rotate(-90deg);
      width: 100%;
      height: 100%;
    }

    .pomodoro-ring-bg {
      fill: none;
      stroke: var(--border);
      stroke-width: 8;
    }

    .pomodoro-ring-progress {
      fill: none;
      stroke: var(--accent);
      stroke-width: 8;
      stroke-linecap: round;
      transition: stroke-dashoffset 0.3s ease;
    }

    .pomodoro-ring-progress.break {
      stroke: #22c55e;
    }

    .pomodoro-ring-time {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .pomodoro-ring-time-display {
      font-size: 48px;
      font-weight: 700;
      font-variant-numeric: tabular-nums;
    }

    .pomodoro-ring-mode-label {
      font-size: 14px;
      color: var(--muted);
      margin-top: 4px;
    }

    /* Calendar Week Numbers */
    .calendar-week-number {
      font-size: 10px;
      color: var(--muted);
      text-align: center;
      padding: 8px 4px;
      font-weight: 500;
    }

    .calendar-grid.with-week-numbers {
      grid-template-columns: 28px repeat(7, 1fr);
    }

    /* Calendar Busy Day Indicator */
    .calendar-day.busy-day {
      box-shadow: inset 0 0 0 2px var(--accent);
    }

    .calendar-day.very-busy-day {
      box-shadow: inset 0 0 0 2px var(--accent), 0 0 12px rgba(102, 126, 234, 0.3);
    }

    .calendar-day-count {
      position: absolute;
      top: 2px;
      left: 2px;
      width: 16px;
      height: 16px;
      background: var(--accent);
      color: white;
      border-radius: 50%;
      font-size: 9px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Calendar Hover Preview */
    .calendar-day-preview {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%) translateY(10px);
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      min-width: 200px;
      max-width: 280px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s ease;
      z-index: 100;
      pointer-events: none;
    }

    .calendar-day:hover .calendar-day-preview {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) translateY(0);
    }

    .calendar-day-preview-title {
      font-weight: 600;
      font-size: 13px;
      margin-bottom: 8px;
      color: var(--text);
    }

    .calendar-day-preview-item {
      font-size: 12px;
      color: var(--muted);
      padding: 4px 0;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .calendar-day-preview-item:last-child {
      border-bottom: none;
    }

    /* Mobile Swipe Actions */
    .task-item-swipe-container {
      position: relative;
      overflow: hidden;
    }

    .task-item-swipe-actions {
      position: absolute;
      top: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      transition: transform 0.2s;
    }

    .task-item-swipe-actions.left {
      right: 100%;
      padding-right: 12px;
    }

    .task-item-swipe-actions.right {
      left: 100%;
      padding-left: 12px;
    }

    .swipe-action-btn {
      width: 60px;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 4px;
      font-size: 11px;
      font-weight: 500;
      border: none;
      cursor: pointer;
    }

    .swipe-action-btn.complete {
      background: #22c55e;
      color: white;
    }

    .swipe-action-btn.delete {
      background: #ef4444;
      color: white;
    }

    .task-item.swiping {
      transition: transform 0.1s ease-out;
      position: relative;
      z-index: 10;
    }

    /* Swipe direction visual feedback */
    .task-item.swiping {
      background: linear-gradient(90deg,
          rgba(34, 197, 94, 0.25) 0%,
          var(--card) 25%,
          var(--card) 75%,
          rgba(239, 68, 68, 0.25) 100%) !important;
    }

    /* Glow when threshold reached */
    .task-item.swipe-threshold-reached {
      box-shadow: 0 0 20px rgba(34, 197, 94, 0.5) !important;
    }

    /* Visual hint badge when ready to complete */
    .task-item.swipe-threshold-reached::after {
      content: '✓';
      position: absolute;
      left: 8px;
      top: 50%;
      transform: translateY(-50%);
      width: 32px;
      height: 32px;
      background: #22c55e;
      color: white;
      border-radius: 50%;
      font-size: 18px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: swipeComplete 0.2s ease-out;
    }

    @keyframes swipeComplete {
      from {
        opacity: 0;
        transform: translateY(-50%) scale(0.5);
      }

      to {
        opacity: 1;
        transform: translateY(-50%) scale(1);
      }
    }

    /* Bottom Sheet Modal (Mobile) */
    @media (max-width: 768px) {
      .task-edit-modal.bottom-sheet .task-edit-card {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        max-height: 85vh;
        border-radius: 24px 24px 0 0;
        margin: 0;
        transform: translateY(100%);
        transition: transform 0.3s ease-out;
      }

      .task-edit-modal.bottom-sheet.open .task-edit-card {
        transform: translateY(0);
      }

      .bottom-sheet-handle {
        width: 36px;
        height: 4px;
        background: var(--border);
        border-radius: 2px;
        margin: 12px auto 8px;
      }
    }

    /* Pull to Refresh */
    .pull-to-refresh {
      position: fixed;
      top: 56px;
      left: 50%;
      transform: translateX(-50%) translateY(-100px);
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s;
      z-index: 10020;
    }

    .pull-to-refresh.pulling,
    .pull-to-refresh.refreshing {
      transform: translateX(-50%) translateY(20px);
    }

    .pull-to-refresh.refreshing .pull-spinner {
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      100% {
        transform: rotate(360deg);
      }
    }

    /* Fuzzy Search Highlight */
    .search-highlight {
      background: rgba(234, 179, 8, 0.3);
      border-radius: 2px;
      padding: 0 2px;
    }

    /* Enhanced Context Menu */
    .context-menu {
      min-width: 180px;
    }

    .context-menu-divider {
      height: 1px;
      background: var(--border);
      margin: 6px 0;
    }

    .context-menu-item-icon {
      width: 20px;
      text-align: center;
      margin-right: 8px;
    }

    .context-menu-item-shortcut {
      margin-left: auto;
      font-size: 11px;
      color: var(--muted);
      padding-left: 16px;
    }

    .context-menu-submenu {
      position: relative;
    }

    .context-menu-submenu::after {
      content: '▶';
      position: absolute;
      right: 8px;
      font-size: 8px;
      color: var(--muted);
    }

    /* Undo/Redo Toast */
    .undo-stack-toast {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      gap: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      z-index: 10000;
      opacity: 0;
      transition: all 0.3s ease;
    }

    .undo-stack-toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    .undo-stack-message {
      font-size: 14px;
      color: var(--text);
    }

    .undo-stack-actions {
      display: flex;
      gap: 8px;
    }

    .undo-stack-btn {
      padding: 6px 14px;
      border: none;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
    }

    .undo-stack-btn.undo {
      background: var(--accent);
      color: white;
    }

    .undo-stack-btn.dismiss {
      background: var(--btn-secondary-bg);
      color: var(--text);
    }

    /* Advanced Recurrence Picker */
    .recurrence-picker {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .recurrence-days {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .recurrence-day-btn {
      width: 36px;
      height: 36px;
      border: 2px solid var(--border);
      border-radius: 50%;
      background: var(--input-bg);
      color: var(--text);
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
    }

    .recurrence-day-btn:hover {
      border-color: var(--accent);
    }

    .recurrence-day-btn.selected {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
    }

    .recurrence-interval {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .recurrence-interval-input {
      width: 60px;
      padding: 8px 12px;
      border: 2px solid var(--border);
      border-radius: 8px;
      font-size: 14px;
      text-align: center;
      background: var(--input-bg);
      color: var(--text);
    }

    /* Vim-style Focus Indicator */
    .task-item.vim-focused {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    /* Enhanced Task Card */
    .task-item.enhanced {
      position: relative;
      border-left: 4px solid transparent;
    }

    .task-item.enhanced.priority-urgent {
      border-left-color: #ef4444;
    }

    .task-item.enhanced.priority-high {
      border-left-color: #f97316;
    }

    .task-item.enhanced.priority-medium {
      border-left-color: #eab308;
    }

    .task-item.enhanced.priority-low {
      border-left-color: #22c55e;
    }

    .task-due-chip {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 500;
      background: var(--day-other);
      color: var(--muted);
    }

    .task-due-chip.overdue {
      background: rgba(239, 68, 68, 0.15);
      color: #ef4444;
    }

    .task-due-chip.today {
      background: rgba(34, 197, 94, 0.15);
      color: #22c55e;
    }

    .task-due-chip.soon {
      background: rgba(234, 179, 8, 0.15);
      color: #ca8a04;
    }

    /* Drag & Drop Calendar */
    .calendar-day.drag-over {
      background: rgba(102, 126, 234, 0.1);
      border-color: var(--accent);
    }

    .task-item.dragging-to-calendar {
      opacity: 0.5;
    }

    /* ============ END ENHANCED FEATURES CSS ============ */

    body {
      font-family: var(--font);
      background-color: var(--bg);
      background-image: var(--bg-gradient);
      min-height: 100vh;
      min-height: 100dvh;
      color: var(--text);
    }

    .app-layout {
      display: flex;
      height: calc(100vh - 60px);
      height: calc(100dvh - 60px);
      align-items: flex-start;
      overflow-y: auto;
      position: relative;
    }

    .sidebar {
      width: 450px;
      min-width: 380px;
      max-width: 90vw;
      background: var(--card);
      border-left: 1px solid var(--border);
      padding: var(--space-4);
      display: flex;
      flex-direction: column;
      order: 1;
      transition: transform 0.3s;
      overflow: visible;
      flex: 0 0 auto;
      box-sizing: border-box;
    }

    .sidebar.hidden {
      transform: translateX(100%);
      position: absolute;
      right: 0;
      top: 0;
      bottom: 0;
    }

    .main-content {
      flex: 1;
      padding: var(--space-6);
      padding-top: 80px;
      overflow-y: visible;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    /* Body offset for fixed header */
    body {
      padding-top: 60px;
    }

    .header {
      text-align: center;
      margin-bottom: var(--space-8);
      color: var(--text);
    }

    .header h1 {
      font-size: var(--font-size-3xl);
      font-weight: var(--font-weight-bold);
      margin-bottom: var(--space-2);
      letter-spacing: -0.5px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header p {
      font-size: 16px;
      color: var(--muted);
    }

    /* Calendar Styles */
    .calendar-container {
      direction: rtl;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      box-shadow: var(--shadow);
      margin-bottom: 14px;
      flex: 0 0 auto;
      overflow: visible;
      width: 100%;
    }

    .calendar-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
      gap: 10px;
      flex-wrap: wrap;
    }

    .calendar-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--text);
    }

    .calendar-nav {
      display: flex;
      gap: 8px;
    }

    .calendar-nav button {
      width: 36px;
      height: 36px;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: var(--card);
      color: var(--text);
      font-size: 18px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .calendar-nav button:hover {
      background: var(--day-hover);
      border-color: var(--accent);
    }

    .calendar-view-toggle {
      display: flex;
      gap: 6px;
      padding: 4px;
      border-radius: 999px;
      background: var(--day-other);
      border: 1px solid var(--border);
    }

    .calendar-view-toggle button {
      border: none;
      background: transparent;
      color: var(--muted);
      font-size: 12px;
      padding: 6px 12px;
      border-radius: 999px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .calendar-view-toggle button:hover {
      color: var(--text);
    }

    .calendar-view-toggle button.active {
      background: var(--accent);
      color: #fff;
      box-shadow: 0 2px 6px rgba(102, 126, 234, 0.25);
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      grid-auto-rows: minmax(56px, auto);
      gap: 4px;
      margin-top: 8px;
      align-items: stretch;
      width: 100%;
      box-sizing: border-box;
    }

    .calendar-day-name {
      text-align: center;
      font-size: 13px;
      font-weight: 600;
      color: var(--muted);
      padding: var(--space-2) 0;
    }

    .calendar-day {
      min-height: 56px;
      padding: var(--space-2);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.15s;
      display: flex;
      flex-direction: column;
      background: var(--card);
      overflow: hidden;
    }

    #taskRightSidebar.calendar-expanded {
      width: 580px;
      min-width: 520px;
    }

    #taskRightSidebar.calendar-expanded .calendar-grid {
      grid-auto-rows: minmax(110px, auto);
    }

    #taskRightSidebar.calendar-expanded .calendar-day {
      min-height: 110px;
      overflow: visible;
      padding: var(--space-2) var(--space-3);
    }

    #taskRightSidebar.calendar-expanded .calendar-day-events {
      overflow: visible;
      gap: 3px;
    }

    #taskRightSidebar.calendar-expanded .calendar-event-chip {
      font-size: 11px;
      padding: 4px 8px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }

    #taskRightSidebar.calendar-expanded .calendar-day-number {
      font-size: var(--font-size-sm);
      margin-bottom: var(--space-2);
    }

    #taskRightSidebar.calendar-view-week .calendar-grid {
      grid-auto-rows: minmax(56px, auto);
    }

    #taskRightSidebar.calendar-view-week .calendar-day {
      min-height: 120px;
    }

    #taskRightSidebar.calendar-view-week.calendar-expanded .calendar-day {
      min-height: 160px;
    }

    #taskRightSidebar.calendar-view-day .calendar-grid {
      grid-template-columns: 1fr;
      grid-auto-rows: minmax(56px, auto);
    }

    #taskRightSidebar.calendar-view-day .calendar-day {
      min-height: 220px;
    }

    #taskRightSidebar.calendar-view-day.calendar-expanded .calendar-day {
      min-height: 300px;
    }

    #taskRightSidebar.calendar-view-day .calendar-day-name {
      text-align: right;
      padding-right: 10px;
    }

    /* Event calendar (sidebar) view modes */
    #sidebar.calendar-view-week .calendar-grid {
      grid-auto-rows: minmax(80px, auto);
    }

    #sidebar.calendar-view-week .calendar-day {
      min-height: 100px;
    }

    #sidebar.calendar-view-day .calendar-grid {
      grid-template-columns: 1fr;
    }

    #sidebar.calendar-view-day .calendar-day {
      min-height: 200px;
    }

    #sidebar.calendar-view-day .calendar-day-name {
      text-align: right;
      padding-right: 10px;
    }

    .calendar-day:hover {
      background: var(--day-hover);
      border-color: var(--border);
    }

    .calendar-day.other-month {
      background: var(--day-other);
      opacity: 0.5;
    }

    .calendar-day.today {
      border: 2px solid var(--accent);
      background: rgba(102, 126, 234, 0.05);
    }

    .calendar-day-number {
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-bold);
      margin-bottom: var(--space-1);
      text-align: right;
      letter-spacing: -0.2px;
    }

    .calendar-day.today .calendar-day-number {
      color: var(--accent);
    }

    .calendar-day-events {
      display: flex;
      flex-direction: column;
      gap: var(--space-1);
      overflow: hidden;
      flex: 1;
      justify-content: flex-start;
    }

    .calendar-event-chip {
      font-size: var(--font-size-xs);
      padding: 3px var(--space-2);
      border-radius: var(--radius-sm);
      white-space: normal;
      overflow: visible;
      text-overflow: clip;
      color: white;
      font-weight: var(--font-weight-semibold);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.12);
      line-height: 1.25;
    }

    .calendar-more {
      font-size: 10px;
      color: var(--muted);
      text-align: center;
      margin-top: 2px;
    }

    /* Monthly Event List */
    .sidebar-section {
      margin-top: var(--space-5);
      padding-top: var(--space-5);
      border-top: 1px solid var(--border);
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .sidebar-section-title {
      font-size: var(--font-size-base);
      font-weight: var(--font-weight-semibold);
      color: var(--text);
      margin-bottom: var(--space-3);
    }

    .month-events {
      display: flex;
      flex-direction: column;
      gap: var(--space-2);
      max-height: none;
      overflow: visible;
      flex: 1;
      min-height: 180px;
    }

    .month-event-item {
      padding: 10px 12px;
      background: var(--day-other);
      border-radius: 8px;
      border-right: 4px solid var(--accent);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .month-event-color {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .month-event-info {
      flex: 1;
      min-width: 0;
    }

    .month-event-name {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .month-event-date {
      font-size: var(--font-size-xs);
      color: var(--muted);
      margin-top: 2px;
    }

    .no-events-msg {
      font-size: var(--font-size-sm);
      color: var(--muted);
      text-align: center;
      padding: var(--space-5);
    }

    /* Input Panel */
    .input-panel {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--space-5);
      box-shadow: var(--shadow);
      margin-bottom: var(--space-5);
      direction: rtl;
    }

    .input-row {
      display: flex;
      gap: var(--space-3);
      align-items: center;
      flex-wrap: wrap;
    }

    .input-row input {
      flex: 1;
      padding: var(--space-3) var(--space-4);
      border: 2px solid var(--border);
      border-radius: var(--radius-md);
      font-size: var(--font-size-base);
      transition: border-color 0.2s, box-shadow 0.2s;
      outline: none;
      direction: rtl;
      text-align: right;
      background: var(--input-bg);
      color: var(--text);
    }

    .input-row input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
    }

    .input-row input[type="text"] {
      min-width: 180px;
    }

    .input-row input[type="datetime-local"] {
      min-width: 260px;
      direction: ltr;
      text-align: left;
    }

    .reminder-select {
      padding: var(--space-3) var(--space-4);
      border: 2px solid var(--border);
      border-radius: var(--radius-md);
      font-size: var(--font-size-base);
      background: var(--input-bg);
      color: var(--text);
      outline: none;
      cursor: pointer;
      min-width: 160px;
    }

    .reminder-select:focus {
      border-color: var(--accent);
    }

    .reminder-custom {
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }

    .reminder-custom.hidden,
    .task-reminder-custom.hidden {
      display: none !important;
    }

    .task-reminder-custom {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      margin-top: var(--space-2);
    }

    .reminder-custom input,
    .reminder-custom select {
      padding: var(--space-3) var(--space-4);
      border: 2px solid var(--border);
      border-radius: var(--radius-md);
      font-size: var(--font-size-base);
      background: var(--input-bg);
      color: var(--text);
      outline: none;
      cursor: pointer;
    }

    .reminder-custom input {
      width: 110px;
      cursor: text;
      direction: ltr;
      text-align: left;
    }

    .reminder-custom select {
      min-width: 150px;
    }

    .reminder-custom input:focus,
    .reminder-custom select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
    }

    .btn {
      padding: var(--space-3) var(--space-6);
      border: none;
      border-radius: var(--radius-md);
      font-size: var(--font-size-base);
      font-weight: var(--font-weight-semibold);
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: white;
      box-shadow: 0 6px 14px rgba(102, 126, 234, 0.25);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }

    .btn-primary:active {
      transform: translateY(0);
    }

    .btn-ghost {
      background: rgba(239, 68, 68, 0.08);
      border: 1px solid rgba(239, 68, 68, 0.2);
      color: #dc2626;
    }

    .btn-ghost:hover {
      background: rgba(239, 68, 68, 0.12);
    }

    .btn-cancel {
      background: var(--btn-secondary-bg);
      color: var(--muted);
      display: none;
    }

    .btn-cancel:hover {
      background: var(--btn-secondary-hover);
    }

    .event-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .event-list.loading .event-row {
      display: none;
    }

    .event-skeleton {
      display: grid;
      gap: 12px;
    }

    .event-skeleton-row {
      height: 78px;
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      background: linear-gradient(90deg, var(--day-other), var(--day-hover), var(--day-other));
      background-size: 200% 100%;
      animation: shimmer 1.2s ease-in-out infinite;
    }

    @keyframes shimmer {
      0% {
        background-position: 0% 50%;
      }

      100% {
        background-position: 200% 50%;
      }
    }

    .event-row {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 18px 18px;
      box-sizing: border-box;
      display: flex;
      align-items: center;
      gap: 16px;
      box-shadow: var(--shadow);
      transition: transform 0.15s, box-shadow 0.15s, background 0.2s;
    }

    .event-row:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-hover);
      border-color: #d7dbe8;
    }

    .event-row.highlighted {
      border: 1px solid var(--event-color, var(--accent));
      box-shadow: 0 0 0 2px var(--event-color-soft, var(--accent-soft));
    }

    .color-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .event-info {
      flex: 1;
      min-width: 0;
      text-align: right;
    }

    .event-name {
      font-size: 18px;
      font-weight: 600;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .event-date {
      font-size: 12px;
      color: var(--muted);
      margin-top: 4px;
    }

    /* Inline editing helpers */
    .inline-edit-input {
      font: inherit;
      color: var(--text);
      background: var(--input-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 6px 8px;
      min-width: 160px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .inline-edit-input:focus {
      outline: 2px solid var(--accent);
      border-color: var(--accent);
    }

    .inline-edit-input[type="datetime-local"] {
      direction: ltr;
      text-align: left;
    }

    .inline-edit-input.small {
      min-width: 260px;
    }

    .priority-popover {
      position: fixed;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-hover);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      z-index: 9999;
      min-width: 180px;
    }

    .priority-popover button {
      padding: 10px 12px;
      background: transparent;
      border: none;
      text-align: right;
      font: inherit;
      cursor: pointer;
    }

    .priority-popover button:hover {
      background: var(--btn-secondary-bg);
    }

    .conflict-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: var(--danger);
      font-size: 13px;
      font-weight: 600;
    }

    .conflict-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--danger);
      display: inline-block;
      box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.18);
    }

    /* ============== DAILY PLANNER STYLES ============== */
    .planner-overlay {
      position: fixed;
      top: 56px;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg);
      z-index: 1000;
      display: none;
      flex-direction: column;
      overflow: hidden;
    }

    .planner-overlay.open {
      display: flex;
    }

    .planner-header-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 24px;
      background: var(--card);
      border-bottom: 1px solid var(--border);
      gap: 16px;
      flex-wrap: wrap;
    }

    .planner-header-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .planner-date-nav {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .planner-date-nav button {
      width: 36px;
      height: 36px;
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      background: var(--card);
      color: var(--text);
      font-size: 18px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .planner-date-nav button:hover {
      background: var(--day-hover);
      border-color: var(--accent);
    }

    .planner-current-date {
      font-size: 16px;
      font-weight: 600;
      color: var(--text);
      min-width: 200px;
      text-align: center;
      cursor: pointer;
      padding: 8px 16px;
      border-radius: var(--radius-md);
      transition: background 0.15s;
    }

    .planner-current-date:hover {
      background: var(--day-hover);
    }

    .planner-today-btn {
      padding: 8px 16px;
      border: 1px solid var(--accent);
      border-radius: var(--radius-md);
      background: transparent;
      color: var(--accent);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
    }

    .planner-today-btn:hover {
      background: var(--accent);
      color: white;
    }

    .planner-view-toggle {
      display: flex;
      gap: 4px;
      padding: 4px;
      border-radius: var(--radius-md);
      background: var(--day-other);
      border: 1px solid var(--border);
    }

    .planner-view-toggle button {
      border: none;
      background: transparent;
      color: var(--muted);
      font-size: 13px;
      padding: 8px 16px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.15s;
      font-weight: 500;
    }

    .planner-view-toggle button:hover {
      color: var(--text);
    }

    .planner-view-toggle button.active {
      background: var(--accent);
      color: white;
    }

    .planner-main {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    /* Planner Sidebar */
    .planner-sidebar {
      width: 320px;
      background: var(--card);
      border-left: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      overflow-x: hidden;
      max-height: calc(100vh - 180px);
    }

    .planner-sidebar.hidden {
      display: none;
    }

    .planner-sidebar-section {
      padding: 16px;
      border-bottom: 1px solid var(--border);
    }

    .planner-sidebar-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .planner-mini-calendar {
      direction: rtl;
    }

    .planner-mini-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .planner-mini-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
    }

    .planner-mini-nav {
      display: flex;
      gap: 4px;
    }

    .planner-mini-nav button {
      width: 24px;
      height: 24px;
      border: none;
      border-radius: 4px;
      background: transparent;
      color: var(--muted);
      font-size: 12px;
      cursor: pointer;
    }

    .planner-mini-nav button:hover {
      background: var(--day-hover);
      color: var(--text);
    }

    .planner-mini-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 2px;
    }

    .planner-mini-day-name {
      text-align: center;
      font-size: 10px;
      color: var(--muted);
      padding: 4px 0;
    }

    .planner-mini-day {
      text-align: center;
      font-size: 12px;
      padding: 6px 4px;
      border-radius: 4px;
      cursor: pointer;
      color: var(--text);
    }

    .planner-mini-day:hover {
      background: var(--day-hover);
    }

    .planner-mini-day.other-month {
      opacity: 0.4;
    }

    .planner-mini-day.today {
      background: rgba(102, 126, 234, 0.15);
      color: var(--accent);
      font-weight: 600;
    }

    .planner-mini-day.selected {
      background: var(--accent);
      color: white;
    }

    .planner-mini-day.has-events::after {
      content: '';
      display: block;
      width: 4px;
      height: 4px;
      background: var(--accent);
      border-radius: 50%;
      margin: 2px auto 0;
    }

    /* Quick Tasks List */
    .planner-quick-tasks {
      flex: 1;
      overflow-y: auto;
    }

    .planner-task-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: var(--radius-sm);
      cursor: grab;
      transition: all 0.15s;
      margin-bottom: 4px;
      background: var(--day-other);
      border-right: 3px solid var(--accent);
    }

    .planner-task-item:hover {
      background: var(--day-hover);
    }

    .planner-task-item.dragging {
      opacity: 0.5;
    }

    .planner-task-item .task-color-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .planner-task-item .task-info {
      flex: 1;
      min-width: 0;
    }

    .planner-task-item .task-title {
      font-size: 13px;
      font-weight: 500;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .planner-task-item .task-subject {
      font-size: 11px;
      color: var(--muted);
    }

    .planner-task-item .task-duration {
      font-size: 11px;
      color: var(--muted);
      background: var(--btn-secondary-bg);
      padding: 2px 6px;
      border-radius: 4px;
    }

    /* Planner Content Area */
    .planner-content {
      flex: 1;
      overflow-y: auto;
      padding: 16px 24px;
      direction: rtl;
    }

    /* Day View */
    .planner-day-view {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      overflow: hidden;
    }

    .planner-day-header {
      padding: 16px 20px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: white;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .planner-day-title {
      font-size: 18px;
      font-weight: 600;
    }

    .planner-day-summary {
      display: flex;
      gap: 20px;
      font-size: 13px;
    }

    .planner-day-summary span {
      opacity: 0.9;
    }

    .planner-timeline {
      position: relative;
    }

    .planner-hour-row {
      display: flex;
      min-height: 60px;
      border-bottom: 1px solid var(--border);
      position: relative;
    }

    .planner-hour-row:last-child {
      border-bottom: none;
    }

    .planner-hour-label {
      width: 70px;
      padding: 8px 12px;
      font-size: 12px;
      font-weight: 600;
      color: var(--muted);
      text-align: center;
      border-left: 1px solid var(--border);
      flex-shrink: 0;
    }

    .planner-hour-content {
      flex: 1;
      position: relative;
      min-height: 60px;
      cursor: pointer;
      transition: background 0.15s;
    }

    .planner-hour-content:hover {
      background: rgba(102, 126, 234, 0.05);
    }

    .planner-hour-content.drop-target {
      background: rgba(102, 126, 234, 0.15);
    }

    /* Time Blocks */
    .planner-block {
      position: absolute;
      right: 4px;
      left: 4px;
      background: var(--priority-bg, var(--day-other));
      border-right: 4px solid var(--priority-color, var(--accent));
      border-radius: var(--radius-sm);
      padding: 6px 10px 6px 32px;
      cursor: grab;
      transition: all 0.15s ease;
      overflow: hidden;
      z-index: 1;
      min-height: 24px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      user-select: none;
      touch-action: none;
    }

    .planner-block:hover {
      box-shadow: var(--shadow-hover);
      transform: scale(1.02);
      z-index: 10;
      overflow: visible;
    }

    .planner-block:active {
      cursor: grabbing;
    }

    .planner-block.dragging {
      opacity: 0.4;
      z-index: 12;
      cursor: grabbing;
      transform: scale(0.98);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transition: opacity 0.1s ease, transform 0.1s ease;
    }

    .planner-block.resizing {
      opacity: 0.6;
      transition: opacity 0.1s ease;
    }

    .planner-block-resize-handle {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      height: 16px;
      cursor: ns-resize;
      opacity: 0.3;
      transition: opacity 0.2s ease;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      padding-bottom: 4px;
      touch-action: none;
      z-index: 2;
    }

    .planner-block-resize-handle::after {
      content: '';
      width: 40px;
      height: 5px;
      border-radius: 999px;
      background: rgba(102, 126, 234, 0.5);
      transition: all 0.2s ease;
    }

    .planner-block-resize-handle:hover::after {
      background: rgba(102, 126, 234, 0.9);
      height: 6px;
      width: 50px;
    }

    body.dark .planner-block-resize-handle::after {
      background: rgba(102, 126, 234, 0.6);
    }

    body.dark .planner-block-resize-handle:hover::after {
      background: rgba(102, 126, 234, 1);
    }

    .planner-block:hover .planner-block-resize-handle {
      opacity: 1;
    }

    .planner-block.resizing .planner-block-resize-handle {
      opacity: 1;
    }

    .planner-block.resizing .planner-block-resize-handle::after {
      background: rgba(102, 126, 234, 1);
      height: 7px;
      width: 60px;
    }

    .planner-block.compact .planner-block-resize-handle {
      height: 12px;
      padding-bottom: 2px;
    }

    .planner-block.extra-compact .planner-block-resize-handle {
      height: 10px;
      padding-bottom: 2px;
    }

    .planner-block-ghost {
      position: absolute;
      pointer-events: none;
      z-index: 25;
      border-radius: var(--radius-sm);
      border: 3px solid rgba(102, 126, 234, 1);
      background: rgba(102, 126, 234, 0.25);
      backdrop-filter: blur(4px);
      box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4), 0 2px 8px rgba(0, 0, 0, 0.15), inset 0 0 0 1px rgba(255, 255, 255, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: top 0.05s ease-out, height 0.05s ease-out;
      animation: pulseGhost 1.5s ease-in-out infinite;
      will-change: top, height;
    }

    @keyframes pulseGhost {

      0%,
      100% {
        box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4), 0 2px 8px rgba(0, 0, 0, 0.15), inset 0 0 0 1px rgba(255, 255, 255, 0.3);
        transform: scale(1);
      }

      50% {
        box-shadow: 0 12px 32px rgba(102, 126, 234, 0.5), 0 4px 12px rgba(0, 0, 0, 0.2), inset 0 0 0 1px rgba(255, 255, 255, 0.5);
        transform: scale(1.01);
      }
    }

    .planner-ghost-time {
      font-size: 12px;
      font-weight: 700;
      color: var(--accent);
      background: rgba(255, 255, 255, 0.98);
      padding: 6px 14px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      white-space: nowrap;
      border: 2px solid rgba(102, 126, 234, 0.3);
      transition: transform 0.2s ease;
    }

    .planner-block-ghost:hover .planner-ghost-time {
      transform: scale(1.05);
    }

    body.dark .planner-ghost-time {
      background: rgba(20, 20, 30, 0.98);
      color: #667eea;
      border-color: rgba(102, 126, 234, 0.5);
    }

    /* Compact mode for 15-30 min events */
    .planner-block.compact {
      flex-direction: row;
      align-items: center;
      gap: 6px;
      padding: 2px 6px 2px 24px;
      min-height: 20px;
    }

    .planner-block.compact .planner-block-title {
      font-size: 11px;
      flex: 1;
      min-width: 0;
    }

    .planner-block.compact .planner-block-time {
      margin-top: 0;
      font-size: 10px;
      flex-shrink: 0;
    }

    .planner-block.compact .planner-block-checkbox {
      width: 14px;
      height: 14px;
      left: 4px;
    }

    /* Extra compact mode for 15 min events */
    .planner-block.extra-compact {
      flex-direction: row;
      align-items: center;
      gap: 4px;
      padding: 1px 4px 1px 20px;
      min-height: 14px;
    }

    .planner-block.extra-compact .planner-block-title {
      font-size: 10px;
      flex: 1;
      min-width: 0;
    }

    .planner-block.extra-compact .planner-block-time {
      margin-top: 0;
      font-size: 9px;
      flex-shrink: 0;
    }

    .planner-block.extra-compact .planner-block-checkbox {
      width: 12px;
      height: 12px;
      left: 3px;
    }

    .planner-block-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 1.3;
    }

    .planner-block-time {
      font-size: 11px;
      color: var(--muted);
      margin-top: 1px;
      line-height: 1.2;
    }

    .planner-block-notes {
      font-size: 11px;
      color: var(--muted);
      margin-top: 3px;
      line-height: 1.3;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: var(--notes-lines, 1);
      line-clamp: var(--notes-lines, 1);
      -webkit-box-orient: vertical;
      opacity: 0.85;
    }

    .planner-block-notes.small-text {
      font-size: 10px;
    }

    .planner-block-notes.tiny-text {
      font-size: 9px;
    }

    .planner-block-reminder {
      font-size: 10px;
      color: var(--accent);
      margin-top: 2px;
    }

    .planner-block-completed {
      opacity: 0.6;
    }

    .planner-block-completed .planner-block-title {
      text-decoration: line-through;
    }

    .planner-block-checkbox {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      left: 6px;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      border: 2px solid var(--priority-color, var(--accent));
      background: transparent;
      cursor: pointer;
      transition: all 0.15s;
    }

    .planner-block-checkbox:hover {
      background: var(--priority-color);
    }

    .planner-block-checkbox.checked {
      background: var(--priority-color, var(--accent));
    }

    .planner-block-checkbox.checked::after {
      content: '✓';
      color: white;
      font-size: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
    }

    /* Current Time Indicator */
    .planner-now-line {
      position: absolute;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, var(--accent) 0%, rgba(102, 126, 234, 0.3) 100%);
      z-index: 5;
      pointer-events: none;
    }

    .planner-now-line::before {
      content: '';
      position: absolute;
      right: -3px;
      top: -3px;
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 4px rgba(102, 126, 234, 0.5);
    }

    .planner-now-label {
      position: absolute;
      left: 4px;
      top: -7px;
      font-size: 9px;
      font-weight: 500;
      color: var(--accent);
      background: var(--card);
      padding: 1px 5px;
      border-radius: 3px;
      opacity: 0.8;
    }

    /* Week View */
    .planner-week-view {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
    }

    .planner-week-day {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      overflow: hidden;
      min-height: 500px;
    }

    .planner-week-day.today {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent);
    }

    .planner-week-day-header {
      padding: 12px;
      text-align: center;
      border-bottom: 1px solid var(--border);
      background: var(--day-other);
    }

    .planner-week-day-name {
      font-size: 12px;
      color: var(--muted);
      font-weight: 500;
    }

    .planner-week-day-number {
      font-size: 20px;
      font-weight: 700;
      color: var(--text);
    }

    .planner-week-day.today .planner-week-day-number {
      color: var(--accent);
    }

    .planner-week-day-content {
      padding: 8px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      min-height: 400px;
    }

    .planner-week-block {
      padding: 8px 10px;
      background: var(--priority-bg, var(--day-other));
      border-right: 3px solid var(--priority-color, var(--accent));
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.15s;
    }

    .planner-week-block:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow);
    }

    .planner-week-block-time {
      font-size: 10px;
      color: var(--muted);
      margin-bottom: 2px;
    }

    .planner-week-block-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Add Block Modal */
    .planner-add-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }

    .planner-add-modal.open {
      display: flex;
    }

    .planner-add-card {
      background: var(--card);
      border-radius: var(--radius-xl);
      padding: 24px;
      width: 100%;
      max-width: 480px;
      max-height: 90vh;
      overflow-y: auto;
      direction: rtl;
    }

    .planner-add-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .planner-add-field {
      margin-bottom: 16px;
    }

    .planner-add-label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 6px;
    }

    .planner-add-input {
      width: 100%;
      padding: 12px 14px;
      border: 2px solid var(--border);
      border-radius: var(--radius-md);
      font-size: 14px;
      background: var(--input-bg);
      color: var(--text);
      outline: none;
      transition: border-color 0.15s;
    }

    .planner-add-input:focus {
      border-color: var(--accent);
    }

    .planner-add-row {
      display: flex;
      gap: 12px;
    }

    .planner-add-row .planner-add-field {
      flex: 1;
    }

    .planner-add-duration-presets {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 8px;
    }

    .planner-duration-btn {
      padding: 6px 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--day-other);
      color: var(--text);
      font-size: 12px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .planner-duration-btn:hover {
      border-color: var(--accent);
    }

    .planner-duration-btn.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    .planner-add-priority {
      display: flex;
      gap: 8px;
    }

    .planner-priority-option {
      flex: 1;
      padding: 10px;
      border: 2px solid var(--border);
      border-radius: var(--radius-md);
      background: transparent;
      cursor: pointer;
      text-align: center;
      font-size: 12px;
      font-weight: 600;
      transition: all 0.15s;
    }

    .planner-priority-option:hover {
      border-color: var(--muted);
    }

    .planner-priority-option.selected {
      border-color: var(--priority-color);
      background: var(--priority-bg);
    }

    .planner-priority-option[data-priority="urgent"] {
      --priority-color: #ef4444;
      --priority-bg: #fef2f2;
    }

    .planner-priority-option[data-priority="high"] {
      --priority-color: #f97316;
      --priority-bg: #fff7ed;
    }

    .planner-priority-option[data-priority="medium"] {
      --priority-color: #eab308;
      --priority-bg: #fefce8;
    }

    .planner-priority-option[data-priority="low"] {
      --priority-color: #22c55e;
      --priority-bg: #f0fdf4;
    }

    .planner-priority-option[data-priority="none"] {
      --priority-color: #6b7280;
      --priority-bg: var(--day-other);
    }

    body.dark .planner-priority-option[data-priority="urgent"] {
      --priority-bg: rgba(239, 68, 68, 0.15);
    }

    body.dark .planner-priority-option[data-priority="high"] {
      --priority-bg: rgba(249, 115, 22, 0.15);
    }

    body.dark .planner-priority-option[data-priority="medium"] {
      --priority-bg: rgba(234, 179, 8, 0.15);
    }

    body.dark .planner-priority-option[data-priority="low"] {
      --priority-bg: rgba(34, 197, 94, 0.15);
    }

    body.dark .planner-priority-option[data-priority="none"] {
      --priority-bg: var(--day-other);
    }

    .planner-add-actions {
      display: flex;
      gap: 12px;
      margin-top: 24px;
    }

    .planner-add-actions button {
      flex: 1;
      padding: 14px;
      border-radius: var(--radius-md);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
    }

    .planner-add-cancel {
      background: var(--btn-secondary-bg);
      border: 1px solid var(--border);
      color: var(--text);
    }

    .planner-add-cancel:hover {
      background: var(--btn-secondary-hover);
    }

    .planner-add-save {
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      border: none;
      color: white;
    }

    .planner-add-save:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-hover);
    }

    .planner-add-delete {
      background: var(--danger);
      border: none;
      color: white;
      flex: 0.5;
    }

    .planner-add-delete:hover {
      opacity: 0.9;
    }

    /* Planner Color Picker */
    .planner-color-picker {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .planner-color-option {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.15s;
      border: 2px solid transparent;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: var(--muted);
    }

    .planner-color-option:hover {
      transform: scale(1.15);
    }

    .planner-color-option.selected {
      box-shadow: 0 0 0 3px var(--accent);
    }

    /* Planner Empty State */
    .planner-empty-hour {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 11px;
      color: var(--muted);
      opacity: 0;
      transition: opacity 0.15s;
      pointer-events: none;
    }

    .planner-hour-content:hover .planner-empty-hour {
      opacity: 1;
    }

    /* Stats Bar */
    .planner-stats-bar {
      display: flex;
      gap: 24px;
      padding: 12px 24px;
      background: var(--card);
      border-bottom: 1px solid var(--border);
    }

    .planner-stat {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .planner-stat-icon {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-sm);
      background: var(--day-other);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .planner-stat-info {
      display: flex;
      flex-direction: column;
    }

    .planner-stat-value {
      font-size: 16px;
      font-weight: 700;
      color: var(--text);
    }

    .planner-stat-label {
      font-size: 11px;
      color: var(--muted);
    }

    /* Templates */
    .planner-templates {
      padding: 16px;
      border-bottom: 1px solid var(--border);
    }

    .planner-template-btn {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      padding: 12px 14px;
      background: var(--day-other);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.15s;
      margin-bottom: 8px;
      font-size: 13px;
      color: var(--text);
    }

    .planner-template-btn:hover {
      border-color: var(--accent);
      background: var(--day-hover);
    }

    .planner-template-icon {
      font-size: 18px;
    }

    /* Planner Sync Sections */
    .planner-sync-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .planner-sync-btn {
      padding: 6px 12px;
      border: 1px solid var(--accent);
      border-radius: var(--radius-sm);
      background: transparent;
      color: var(--accent);
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .planner-sync-btn:hover {
      background: var(--accent);
      color: white;
    }

    .planner-sync-btn.syncing {
      opacity: 0.6;
      pointer-events: none;
    }

    .planner-sync-all-btn {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid var(--accent);
      border-radius: var(--radius-md);
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      color: var(--accent);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-bottom: 12px;
    }

    .planner-sync-all-btn:hover {
      background: var(--accent);
      color: white;
    }

    .planner-countdown-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.15s;
      margin-bottom: 4px;
      background: var(--day-other);
      border-right: 3px solid var(--accent);
    }

    .planner-countdown-item:hover {
      background: var(--day-hover);
    }

    .planner-countdown-item .countdown-color-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .planner-countdown-item .countdown-info {
      flex: 1;
      min-width: 0;
    }

    .planner-countdown-item .countdown-title {
      font-size: 13px;
      font-weight: 500;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .planner-countdown-item .countdown-date {
      font-size: 11px;
      color: var(--muted);
    }

    .planner-countdown-item .countdown-time-left {
      font-size: 10px;
      color: var(--accent);
      background: rgba(102, 126, 234, 0.1);
      padding: 2px 6px;
      border-radius: 4px;
      font-weight: 600;
    }

    .planner-countdown-item .add-to-planner-btn {
      width: 24px;
      height: 24px;
      border: none;
      border-radius: 50%;
      background: var(--btn-secondary-bg);
      color: var(--muted);
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.15s;
      flex-shrink: 0;
    }

    .planner-countdown-item .add-to-planner-btn:hover {
      background: var(--accent);
      color: white;
    }

    .planner-scheduled-task-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.15s;
      margin-bottom: 4px;
      background: var(--day-other);
      border-right: 3px solid var(--success);
    }

    .planner-scheduled-task-item:hover {
      background: var(--day-hover);
    }

    .planner-scheduled-task-item .task-color-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .planner-scheduled-task-item .task-info {
      flex: 1;
      min-width: 0;
    }

    .planner-scheduled-task-item .task-title {
      font-size: 13px;
      font-weight: 500;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .planner-scheduled-task-item .task-due {
      font-size: 11px;
      color: var(--muted);
    }

    .planner-scheduled-task-item .add-to-planner-btn {
      width: 24px;
      height: 24px;
      border: none;
      border-radius: 50%;
      background: var(--btn-secondary-bg);
      color: var(--muted);
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.15s;
      flex-shrink: 0;
    }

    .planner-scheduled-task-item .add-to-planner-btn:hover {
      background: var(--success);
      color: white;
    }

    .planner-synced-indicator {
      font-size: 10px;
      color: var(--success);
      display: flex;
      align-items: center;
      gap: 3px;
    }

    .planner-section-collapse {
      cursor: pointer;
      user-select: none;
    }

    .planner-section-collapse .collapse-icon {
      transition: transform 0.2s;
    }

    .planner-section-collapse.collapsed .collapse-icon {
      transform: rotate(-90deg);
    }

    .planner-section-content {
      max-height: 300px;
      overflow-y: auto;
      transition: max-height 0.3s;
    }

    .planner-section-content.collapsed {
      max-height: 0;
      overflow: hidden;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .planner-sidebar {
        width: 280px;
      }

      .planner-week-view {
        grid-template-columns: repeat(4, 1fr);
      }
    }

    @media (max-width: 768px) {
      .planner-sidebar {
        display: none;
      }

      .planner-header-bar {
        padding: 12px 16px;
        flex-wrap: wrap;
      }

      .planner-week-view {
        grid-template-columns: repeat(2, 1fr);
      }

      .planner-content {
        padding: 12px 16px;
      }

      .planner-stats-bar {
        flex-wrap: wrap;
        gap: 16px;
        padding: 12px 16px;
      }
    }

    /* Pomodoro - Fullscreen like Task Manager */
    .pomodoro-overlay {
      position: fixed;
      top: 56px;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg);
      display: none;
      flex-direction: column;
      z-index: 300;
      overflow: hidden;
    }

    .pomodoro-overlay.open {
      display: flex;
    }

    .pomodoro-header-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 32px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      border-bottom: 1px solid var(--border);
    }

    .pomodoro-header-title {
      font-size: 22px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    @media (max-width: 768px) {
      .event-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }

      .inline-edit-input.small {
        min-width: 0;
        width: 100%;
      }

      .event-actions {
        width: 100%;
        justify-content: flex-end;
      }

      .timer {
        width: 100%;
        justify-content: space-between;
      }

      .event-info {
        width: 100%;
      }

      /* Responsive Pomodoro */
      .pomodoro-card {
        padding: 24px;
        gap: 24px;
        border-radius: 24px;
      }

      .pomodoro-timer-wrap {
        width: 240px;
        height: 240px;
      }

      .pomodoro-time {
        font-size: 52px;
      }

      .pomodoro-btn {
        width: 52px;
        height: 52px;
        font-size: 20px;
      }

      .pomodoro-btn.primary {
        width: 64px;
        height: 64px;
        font-size: 28px;
      }

      .pomodoro-settings-panel {
        grid-template-columns: repeat(2, 1fr);
      }

      .pomodoro-stats {
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
      }

      .pomodoro-stat {
        padding: 16px 8px;
      }

      .pomodoro-stat .value {
        font-size: 24px;
      }

      .pomodoro-presets {
        gap: 8px;
      }

      .pomodoro-preset {
        padding: 10px 16px;
        font-size: 12px;
      }

      .pomodoro-header-bar {
        padding: 12px 16px;
      }

      .pomodoro-content {
        padding: 20px 16px;
      }

      .pomodoro-timer-wrap {
        width: 260px;
        height: 260px;
      }
    }

    .pomodoro-container {
      width: 100%;
      max-width: 640px;
    }

    .pomodoro-card {
      background: linear-gradient(145deg, var(--card) 0%, var(--card) 100%);
      border: 1px solid rgba(102, 126, 234, 0.2);
      border-radius: 32px;
      padding: 48px 40px;
      box-shadow:
        0 25px 80px rgba(102, 126, 234, 0.2),
        0 10px 30px rgba(0, 0, 0, 0.08),
        0 0 0 1px rgba(255, 255, 255, 0.15) inset,
        0 0 80px rgba(102, 126, 234, 0.05) inset;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 36px;
      overflow: visible;
      backdrop-filter: blur(20px);
      position: relative;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .pomodoro-card::before {
      content: '';
      position: absolute;
      top: -1px;
      left: 20%;
      right: 20%;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.5), rgba(118, 75, 162, 0.5), transparent);
      border-radius: 999px;
    }

    .pomodoro-card:hover {
      transform: translateY(-2px);
      box-shadow:
        0 30px 90px rgba(102, 126, 234, 0.25),
        0 15px 40px rgba(0, 0, 0, 0.1),
        0 0 0 1px rgba(255, 255, 255, 0.2) inset,
        0 0 100px rgba(102, 126, 234, 0.08) inset;
    }

    /* Timer Circle */
    .pomodoro-timer-wrap {
      position: relative;
      width: 300px;
      height: 300px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .pomodoro-timer-wrap::before {
      content: '';
      position: absolute;
      inset: -20px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(102, 126, 234, 0.15) 0%, transparent 70%);
      animation: timerGlow 3s ease-in-out infinite;
      pointer-events: none;
    }

    .pomodoro-timer-ring {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background: conic-gradient(from -90deg,
          var(--accent) 0%,
          var(--accent2) calc(var(--progress, 0%) * 0.5),
          var(--accent) var(--progress, 0%),
          rgba(102, 126, 234, 0.15) var(--progress, 0%),
          rgba(102, 126, 234, 0.08) 100%);
      padding: 10px;
      box-shadow:
        0 0 40px rgba(102, 126, 234, 0.3),
        inset 0 0 30px rgba(102, 126, 234, 0.1);
      transition: background 0.3s ease;
    }

    .pomodoro-timer-ring::before {
      content: '';
      position: absolute;
      inset: 10px;
      background: var(--card);
      border-radius: 50%;
      box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.05);
    }

    .pomodoro-timer-ring::after {
      content: '';
      position: absolute;
      inset: 6px;
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.1);
      pointer-events: none;
    }

    .pomodoro-timer {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .pomodoro-time {
      font-size: 64px;
      font-weight: 300;
      letter-spacing: -2px;
      color: var(--text);
      font-variant-numeric: tabular-nums;
      line-height: 1;
      text-shadow: 0 2px 20px rgba(102, 126, 234, 0.2);
    }

    .pomodoro-mode {
      font-size: 14px;
      font-weight: 600;
      color: var(--accent);
      margin-top: 16px;
      text-transform: uppercase;
      letter-spacing: 3px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .pomodoro-mode-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
        transform: scale(1);
      }

      50% {
        opacity: 0.5;
        transform: scale(0.8);
      }
    }

    .pomodoro-next {
      font-size: 13px;
      color: var(--muted);
      margin-top: 8px;
    }

    /* Controls */
    .pomodoro-controls {
      display: flex;
      gap: 20px;
      justify-content: center;
      align-items: center;
    }

    .pomodoro-btn {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      backdrop-filter: blur(10px);
      color: var(--text);
      font-size: 22px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2);
      position: relative;
      overflow: hidden;
    }

    .pomodoro-btn::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 50%;
      padding: 2px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
    }

    .pomodoro-btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    .pomodoro-btn:active {
      transform: translateY(0) scale(0.98);
    }

    .pomodoro-btn.primary {
      width: 72px;
      height: 72px;
      font-size: 28px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: white;
      box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4), 0 0 0 4px rgba(102, 126, 234, 0.15);
    }

    .pomodoro-btn.primary::before {
      display: none;
    }

    .pomodoro-btn.primary:hover {
      transform: translateY(-4px) scale(1.08);
      box-shadow: 0 12px 40px rgba(102, 126, 234, 0.5), 0 0 0 6px rgba(102, 126, 234, 0.2);
    }

    /* Presets */
    .pomodoro-presets {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .pomodoro-preset {
      padding: 12px 24px;
      border-radius: 24px;
      border: 2px solid var(--border);
      background: transparent;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      color: var(--muted);
      transition: all 0.2s;
    }

    .pomodoro-preset:hover {
      color: var(--text);
      border-color: var(--accent);
      transform: translateY(-2px);
    }

    .pomodoro-preset.active {
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      border-color: transparent;
      color: white;
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
    }

    /* Settings Panel */
    .pomodoro-settings-panel {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      padding: 24px;
      background: var(--btn-secondary-bg);
      border-radius: 20px;
      width: 100%;
      max-width: 500px;
    }

    .pomodoro-field {
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: center;
    }

    .pomodoro-field label {
      font-size: 11px;
      font-weight: 600;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .pomodoro-field input {
      width: 70px;
      padding: 12px;
      border: 2px solid var(--border);
      border-radius: 12px;
      background: var(--card);
      color: var(--text);
      font-size: 18px;
      font-weight: 600;
      text-align: center;
      transition: all 0.2s;
    }

    .pomodoro-field input:focus {
      border-color: var(--accent);
      outline: none;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
    }

    /* Options Row */
    .pomodoro-options {
      display: flex;
      gap: 24px;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
    }

    .pomodoro-option {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 20px;
      background: var(--btn-secondary-bg);
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .pomodoro-option:hover {
      background: var(--btn-secondary-hover);
    }

    .pomodoro-option input[type="checkbox"] {
      width: 20px;
      height: 20px;
      accent-color: var(--accent);
      cursor: pointer;
    }

    .pomodoro-option label {
      font-size: 14px;
      color: var(--text);
      cursor: pointer;
    }

    .pomodoro-sound-select {
      padding: 12px 16px;
      border: 2px solid var(--border);
      border-radius: 12px;
      background: var(--card);
      color: var(--text);
      font-size: 14px;
      cursor: pointer;
    }

    .pomodoro-preview-btn {
      padding: 12px 16px;
      border: 2px solid var(--border);
      border-radius: 12px;
      background: var(--card);
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s;
    }

    .pomodoro-preview-btn:hover {
      border-color: var(--accent);
      background: var(--btn-secondary-bg);
    }

    /* Stats Cards */
    .pomodoro-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      width: 100%;
      max-width: 500px;
    }

    .pomodoro-stat {
      padding: 24px 16px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      border-radius: 20px;
      text-align: center;
      border: 1px solid rgba(102, 126, 234, 0.2);
    }

    .pomodoro-stat .label {
      font-size: 11px;
      font-weight: 600;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }

    .pomodoro-stat .value {
      font-size: 32px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Day Progress */
    .pomodoro-daily {
      width: 100%;
      max-width: 500px;
      text-align: center;
    }

    .pomodoro-daily-bar {
      height: 8px;
      background: var(--border);
      border-radius: 999px;
      overflow: hidden;
      margin-bottom: 12px;
    }

    .pomodoro-daily-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #10b981, #22d3ee);
      border-radius: 999px;
      transition: width 0.5s ease;
    }

    .pomodoro-daily-label {
      font-size: 13px;
      color: var(--muted);
    }

    /* Task Select */
    .pomodoro-task-select {
      width: 100%;
      max-width: 400px;
      padding: 14px 20px;
      border: 2px solid var(--border);
      border-radius: 16px;
      background: var(--card);
      color: var(--text);
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .pomodoro-task-select:focus {
      border-color: var(--accent);
      outline: none;
    }

    /* Pomodoro Mini Player */
    .pomodoro-mini {
      position: fixed;
      bottom: 90px;
      right: 24px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 16px 24px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      display: none;
      align-items: center;
      gap: 16px;
      z-index: 2147483647;
      cursor: pointer;
      transition: all 0.3s;
      touch-action: none;
    }

    .pomodoro-mini.visible {
      display: flex !important;
      visibility: visible !important;
      opacity: 1 !important;
    }

    .pomodoro-mini.dragging {
      transition: none;
      opacity: 0.95;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.28);
    }

    .pomodoro-mini:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
    }

    .pomodoro-mini.dragging:hover {
      transform: none;
    }

    .pomodoro-mini-time {
      font-size: 28px;
      font-weight: 700;
      font-variant-numeric: tabular-nums;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .pomodoro-mini-mode {
      font-size: 12px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .pomodoro-mini-close {
      border: none;
      background: var(--btn-secondary-bg);
      color: var(--muted);
      font-size: 18px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .pomodoro-mini-close:hover {
      background: var(--danger);
      color: white;
    }

    /* Picture-in-Picture button styling */
    #pomodoroPiP {
      position: relative;
    }

    #pomodoroPiP.active {
      background: var(--accent);
      color: white;
    }

    @media (max-width: 768px) {
      .event-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }

      .event-actions {
        width: 100%;
        justify-content: flex-end;
      }

      .timer {
        width: 100%;
        justify-content: space-between;
      }

      .event-info {
        width: 100%;
      }

      /* Responsive Pomodoro */
      .pomodoro-card {
        padding: 24px;
        gap: 24px;
        border-radius: 24px;
      }

      .pomodoro-timer-wrap {
        width: 240px;
        height: 240px;
      }

      .pomodoro-time {
        font-size: 52px;
      }

      .pomodoro-btn {
        width: 52px;
        height: 52px;
        font-size: 20px;
      }

      .pomodoro-btn.primary {
        width: 64px;
        height: 64px;
        font-size: 28px;
      }

      .pomodoro-settings-panel {
        grid-template-columns: repeat(2, 1fr);
      }

      .pomodoro-stats {
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
      }

      .pomodoro-stat {
        padding: 16px 8px;
      }

      .pomodoro-stat .value {
        font-size: 24px;
      }

      .pomodoro-presets {
        gap: 8px;
      }

      .pomodoro-preset {
        padding: 10px 16px;
        font-size: 12px;
      }

      .pomodoro-header-bar {
        padding: 12px 16px;
      }

      .pomodoro-content {
        padding: 20px 16px;
      }
    }

    /* Pomodoro - Fullscreen like Task Manager */
    .pomodoro-overlay {
      position: fixed;
      top: 56px;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg);
      display: none;
      flex-direction: column;
      z-index: 300;
      overflow: hidden;
    }

    .pomodoro-overlay.open {
      display: flex;
    }

    .pomodoro-header-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 32px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      border-bottom: 1px solid var(--border);
    }

    .pomodoro-header-title {
      font-size: 22px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .pomodoro-content {
      flex: 1;
      overflow-y: auto;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 40px 24px;
      background:
        radial-gradient(ellipse at 20% 0%, rgba(102, 126, 234, 0.12) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 100%, rgba(118, 75, 162, 0.1) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 50%, rgba(102, 126, 234, 0.03) 0%, transparent 70%),
        linear-gradient(180deg, var(--bg) 0%, var(--bg) 100%);
      position: relative;
    }

    .pomodoro-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      opacity: 0.015;
      pointer-events: none;
    }

    .pomodoro-container {
      width: 100%;
      max-width: 640px;
    }

    .pomodoro-card {
      background: linear-gradient(145deg, var(--card) 0%, var(--card) 100%);
      border: 1px solid rgba(102, 126, 234, 0.2);
      border-radius: 32px;
      padding: 48px 40px;
      box-shadow:
        0 25px 80px rgba(102, 126, 234, 0.2),
        0 10px 30px rgba(0, 0, 0, 0.08),
        0 0 0 1px rgba(255, 255, 255, 0.15) inset,
        0 0 80px rgba(102, 126, 234, 0.05) inset;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 36px;
      overflow: visible;
      backdrop-filter: blur(20px);
      position: relative;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .pomodoro-card::before {
      content: '';
      position: absolute;
      top: -1px;
      left: 20%;
      right: 20%;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.5), rgba(118, 75, 162, 0.5), transparent);
      border-radius: 999px;
    }

    .pomodoro-card:hover {
      transform: translateY(-2px);
      box-shadow:
        0 30px 90px rgba(102, 126, 234, 0.25),
        0 15px 40px rgba(0, 0, 0, 0.1),
        0 0 0 1px rgba(255, 255, 255, 0.2) inset,
        0 0 100px rgba(102, 126, 234, 0.08) inset;
    }

    /* Timer Circle */
    .pomodoro-timer-wrap {
      position: relative;
      width: 300px;
      height: 300px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .pomodoro-timer-wrap::before {
      content: '';
      position: absolute;
      inset: -20px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(102, 126, 234, 0.15) 0%, transparent 70%);
      animation: timerGlow 3s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes timerGlow {

      0%,
      100% {
        opacity: 0.5;
        transform: scale(1);
      }

      50% {
        opacity: 0.8;
        transform: scale(1.05);
      }
    }

    .pomodoro-timer-ring {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background: conic-gradient(from -90deg,
          var(--accent) 0%,
          var(--accent2) calc(var(--progress, 0%) * 0.5),
          var(--accent) var(--progress, 0%),
          rgba(102, 126, 234, 0.15) var(--progress, 0%),
          rgba(102, 126, 234, 0.08) 100%);
      padding: 10px;
      box-shadow:
        0 0 40px rgba(102, 126, 234, 0.3),
        inset 0 0 30px rgba(102, 126, 234, 0.1);
      transition: background 0.3s ease;
    }

    .pomodoro-timer-ring::before {
      content: '';
      position: absolute;
      inset: 10px;
      background: var(--card);
      border-radius: 50%;
      box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.05);
    }

    .pomodoro-timer-ring::after {
      content: '';
      position: absolute;
      inset: 6px;
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.1);
      pointer-events: none;
    }

    .pomodoro-timer {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .pomodoro-time {
      font-size: 72px;
      font-weight: 200;
      letter-spacing: -3px;
      color: var(--text);
      font-variant-numeric: tabular-nums;
      line-height: 1;
      text-shadow: 0 4px 30px rgba(102, 126, 234, 0.25);
      background: linear-gradient(135deg, var(--text) 0%, var(--accent) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .pomodoro-mode {
      font-size: 13px;
      font-weight: 700;
      color: var(--accent);
      margin-top: 20px;
      text-transform: uppercase;
      letter-spacing: 4px;
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 16px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      border-radius: 999px;
      border: 1px solid rgba(102, 126, 234, 0.2);
    }

    .pomodoro-mode-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      animation: pulseGlow 2s ease-in-out infinite;
      box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
    }

    @keyframes pulseGlow {

      0%,
      100% {
        opacity: 1;
        transform: scale(1);
        box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
      }

      50% {
        opacity: 0.7;
        transform: scale(0.85);
        box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
      }
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
        transform: scale(1);
      }

      50% {
        opacity: 0.5;
        transform: scale(0.8);
      }
    }

    .pomodoro-next {
      font-size: 13px;
      color: var(--muted);
      margin-top: 8px;
    }

    /* Controls */
    .pomodoro-controls {
      display: flex;
      gap: 20px;
      justify-content: center;
      align-items: center;
    }

    .pomodoro-btn {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      backdrop-filter: blur(10px);
      color: var(--text);
      font-size: 22px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2);
      position: relative;
      overflow: hidden;
    }

    .pomodoro-btn::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 50%;
      padding: 2px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
    }

    .pomodoro-btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    .pomodoro-btn:active {
      transform: translateY(0) scale(0.98);
    }

    .pomodoro-btn.primary {
      width: 72px;
      height: 72px;
      font-size: 28px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: white;
      box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4), 0 0 0 4px rgba(102, 126, 234, 0.15);
    }

    .pomodoro-btn.primary::before {
      display: none;
    }

    .pomodoro-btn.primary:hover {
      transform: translateY(-4px) scale(1.08);
      box-shadow: 0 12px 40px rgba(102, 126, 234, 0.5), 0 0 0 6px rgba(102, 126, 234, 0.2);
    }

    /* Presets */
    .pomodoro-presets {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .pomodoro-preset {
      padding: 12px 24px;
      border-radius: 24px;
      border: 2px solid var(--border);
      background: transparent;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      color: var(--muted);
      transition: all 0.2s;
    }

    .pomodoro-preset:hover {
      color: var(--text);
      border-color: var(--accent);
      transform: translateY(-2px);
    }

    .pomodoro-preset.active {
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      border-color: transparent;
      color: white;
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
    }

    /* Settings Panel */
    .pomodoro-settings-panel {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      padding: 24px;
      background: var(--btn-secondary-bg);
      border-radius: 20px;
      width: 100%;
      max-width: 500px;
    }

    .pomodoro-field {
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: center;
    }

    .pomodoro-field label {
      font-size: 11px;
      font-weight: 600;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .pomodoro-field input {
      width: 70px;
      padding: 12px;
      border: 2px solid var(--border);
      border-radius: 12px;
      background: var(--card);
      color: var(--text);
      font-size: 18px;
      font-weight: 600;
      text-align: center;
      transition: all 0.2s;
    }

    .pomodoro-field input:focus {
      border-color: var(--accent);
      outline: none;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
    }

    /* Options Row */
    .pomodoro-options {
      display: flex;
      gap: 24px;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
    }

    .pomodoro-option {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 20px;
      background: var(--btn-secondary-bg);
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .pomodoro-option:hover {
      background: var(--btn-secondary-hover);
    }

    .pomodoro-option input[type="checkbox"] {
      width: 20px;
      height: 20px;
      accent-color: var(--accent);
      cursor: pointer;
    }

    .pomodoro-option label {
      font-size: 14px;
      color: var(--text);
      cursor: pointer;
    }

    .pomodoro-sound-select {
      padding: 12px 16px;
      border: 2px solid var(--border);
      border-radius: 12px;
      background: var(--card);
      color: var(--text);
      font-size: 14px;
      cursor: pointer;
    }

    .pomodoro-preview-btn {
      padding: 12px 16px;
      border: 2px solid var(--border);
      border-radius: 12px;
      background: var(--card);
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s;
    }

    .pomodoro-preview-btn:hover {
      border-color: var(--accent);
      background: var(--btn-secondary-bg);
    }

    /* Stats Cards */
    .pomodoro-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      width: 100%;
      max-width: 500px;
    }

    .pomodoro-stat {
      padding: 24px 16px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      border-radius: 20px;
      text-align: center;
      border: 1px solid rgba(102, 126, 234, 0.2);
    }

    .pomodoro-stat .label {
      font-size: 11px;
      font-weight: 600;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }

    .pomodoro-stat .value {
      font-size: 32px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Day Progress */
    .pomodoro-daily {
      width: 100%;
      max-width: 500px;
      text-align: center;
    }

    .pomodoro-daily-bar {
      height: 8px;
      background: var(--border);
      border-radius: 999px;
      overflow: hidden;
      margin-bottom: 12px;
    }

    .pomodoro-daily-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #10b981, #22d3ee);
      border-radius: 999px;
      transition: width 0.5s ease;
    }

    .pomodoro-daily-label {
      font-size: 13px;
      color: var(--muted);
    }

    /* Task Select */
    .pomodoro-task-select {
      width: 100%;
      max-width: 400px;
      padding: 14px 20px;
      border: 2px solid var(--border);
      border-radius: 16px;
      background: var(--card);
      color: var(--text);
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .pomodoro-task-select:focus {
      border-color: var(--accent);
      outline: none;
    }

    /* Pomodoro Mini Player */
    .pomodoro-mini {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 16px 24px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      display: none;
      align-items: center;
      gap: 16px;
      z-index: 9999;
      cursor: pointer;
      transition: all 0.3s;
    }

    .pomodoro-mini.visible {
      display: flex;
    }

    .pomodoro-mini:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
    }

    .pomodoro-mini-time {
      font-size: 28px;
      font-weight: 700;
      font-variant-numeric: tabular-nums;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .pomodoro-mini-mode {
      font-size: 12px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .pomodoro-mini-close {
      border: none;
      background: var(--btn-secondary-bg);
      color: var(--muted);
      font-size: 18px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .pomodoro-mini-close:hover {
      background: var(--danger);
      color: white;
    }

    .star-btn {
      width: 36px;
      height: 36px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--muted);
      cursor: pointer;
      border-radius: 10px;
      transition: background 0.15s, color 0.15s, border-color 0.15s;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
    }

    .star-btn:hover {
      background: var(--day-hover);
      color: var(--accent);
      border-color: rgba(102, 126, 234, 0.15);
    }

    .star-btn.active {
      color: var(--accent);
      --icon-fill: 1;
    }

    .pin-btn {
      width: 36px;
      height: 36px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--muted);
      cursor: pointer;
      border-radius: 10px;
      transition: background 0.15s, color 0.15s, border-color 0.15s;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
    }

    .pin-btn:hover {
      background: var(--day-hover);
      color: var(--accent);
      border-color: rgba(102, 126, 234, 0.15);
    }

    .pin-btn.pinned {
      color: var(--accent);
      --icon-fill: 1;
    }

    .pin-btn.pinned:hover {
      border-color: rgba(102, 126, 234, 0.25);
    }

    .edit-btn {
      width: 36px;
      height: 36px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--muted);
      cursor: pointer;
      border-radius: 10px;
      transition: background 0.15s, color 0.15s, border-color 0.15s;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
    }

    .edit-btn:hover {
      background: var(--day-hover);
      color: var(--accent);
      border-color: rgba(102, 126, 234, 0.15);
    }

    .event-reminder-wrap {
      position: relative;
    }

    .reminder-btn {
      width: 36px;
      height: 36px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--muted);
      cursor: pointer;
      border-radius: 10px;
      transition: background 0.15s, color 0.15s, border-color 0.15s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .reminder-btn:hover {
      background: var(--day-hover);
      color: var(--accent);
      border-color: rgba(102, 126, 234, 0.15);
    }

    .reminder-btn.has-reminder {
      color: var(--accent);
      background: var(--accent-soft);
      border-color: rgba(102, 126, 234, 0.2);
    }

    .event-reminder-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 10px;
      box-shadow: var(--shadow-hover);
      padding: 8px;
      display: none;
      z-index: 100;
      min-width: 140px;
    }

    .event-reminder-dropdown.open {
      display: block;
    }

    .event-reminder-option {
      padding: 8px 12px;
      font-size: 13px;
      color: var(--text);
      cursor: pointer;
      border-radius: 6px;
      transition: background 0.15s;
      white-space: nowrap;
    }

    .event-reminder-option:hover {
      background: var(--day-hover);
    }

    .event-reminder-option.active {
      background: rgba(102, 126, 234, 0.1);
      color: var(--accent);
    }

    .event-reminder-option.remove {
      color: #ef4444;
    }

    .timer {
      display: flex;
      gap: 12px;
    }

    .time-unit {
      text-align: center;
      background: var(--day-other);
      border: 1px solid transparent;
      border-radius: 10px;
      padding: 10px 12px;
      min-width: 64px;
      transition: background 0.2s, border-color 0.2s;
    }

    .time-unit:hover {
      background: var(--day-hover);
      border-color: rgba(102, 126, 234, 0.12);
    }

    .time-val {
      display: block;
      font-size: 24px;
      font-weight: 700;
      font-variant-numeric: tabular-nums;
      line-height: 1.1;
    }

    .time-label {
      display: block;
      font-size: 9px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.6px;
      margin-top: 4px;
    }

    .badge {
      font-size: 11px;
      font-weight: 600;
      padding: 5px 10px;
      border-radius: 20px;
      white-space: nowrap;
    }

    .badge-upcoming {
      background: var(--accent-soft);
      color: var(--accent);
    }

    .badge-ended {
      background: rgba(239, 68, 68, 0.1);
      color: #dc2626;
    }

    .delete-btn {
      width: 36px;
      height: 36px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--muted);
      font-size: 20px;
      cursor: pointer;
      border-radius: 10px;
      transition: background 0.15s, color 0.15s, border-color 0.15s;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
    }

    .delete-btn:hover {
      background: rgba(239, 68, 68, 0.12);
      color: var(--danger);
      border-color: rgba(239, 68, 68, 0.2);
    }

    .event-actions {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .empty-state {
      text-align: center;
      padding: 40px 20px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      color: var(--muted);
      display: none;
    }

    .empty-state svg {
      width: 48px;
      height: 48px;
      margin-bottom: 12px;
      opacity: 0.4;
    }

    .empty-state p {
      font-size: 14px;
    }

    .input-panel.editing {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
    }

    /* Undo toast */
    .undo-toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 220;
      display: none;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: white;
      border-radius: 12px;
      box-shadow: var(--shadow-hover);
      font-size: 14px;
    }

    .undo-toast.show {
      display: flex;
    }

    .undo-toast button {
      border: none;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.15s;
    }

    .undo-toast button:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* AI Loading Toast */
    .ai-loading-toast {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 250;
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4);
      font-size: 14px;
      font-weight: 500;
      animation: slideUpFadeIn 0.3s ease-out;
    }

    .ai-loading-spinner {
      width: 20px;
      height: 20px;
      border: 2.5px solid rgba(255, 255, 255, 0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    @keyframes slideUpFadeIn {
      from {
        opacity: 0;
        transform: translateX(-50%) translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    }

    /* Clear confirmation modal */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.35);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 200;
      padding: 16px;
    }

    .modal-backdrop.open {
      display: flex;
    }

    /* Responsive */
    .modal-card {
      align-items: center;
      justify-content: center;
      z-index: 200;
      padding: 16px;
    }

    .modal-backdrop.open {
      display: flex;
    }

    .modal-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 20px;
      max-width: 420px;
      width: 100%;
      box-shadow: var(--shadow-hover);
      text-align: center;
    }

    .modal-card h3 {
      font-size: 18px;
      margin-bottom: 8px;
      color: var(--text);
    }

    .modal-card p {
      color: var(--muted);
      margin-bottom: 16px;
      line-height: 1.4;
    }

    .modal-actions {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .modal-actions .btn {
      padding: var(--space-3) var(--space-4);
    }

    .btn-danger {
      background: var(--danger);
      color: white;
    }

    .btn-danger:hover {
      background: #dc2626;
    }

    /* Shortcut cheat sheet */
    .shortcuts-backdrop {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(102, 126, 234, 0.25), rgba(15, 23, 42, 0.65));
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 12000;
      padding: 20px;
      backdrop-filter: blur(8px);
    }

    .shortcuts-backdrop.open {
      display: flex;
    }

    .shortcuts-card {
      width: min(760px, 100%);
      background: var(--card);
      border-radius: 22px;
      border: 1px solid rgba(102, 126, 234, 0.35);
      box-shadow: 0 24px 70px rgba(15, 23, 42, 0.35), 0 0 0 1px rgba(255, 255, 255, 0.25) inset;
      overflow: hidden;
      direction: rtl;
    }

    .shortcuts-hero {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      padding: 22px 26px 18px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.18), rgba(118, 75, 162, 0.12));
      border-bottom: 1px solid var(--border);
    }

    .shortcuts-eyebrow {
      font-size: 12px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .shortcuts-title {
      font-size: 22px;
      font-weight: 700;
      margin-top: 6px;
    }

    .shortcuts-subtitle {
      font-size: 13px;
      color: var(--muted);
      margin-top: 6px;
    }

    .shortcuts-close {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 1px solid var(--border);
      background: var(--day-other);
      color: var(--text);
      font-size: 20px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .shortcuts-close:hover {
      background: var(--day-hover);
      transform: translateY(-1px);
    }

    .shortcuts-body {
      padding: 20px 26px 26px;
    }

    .shortcuts-section {
      margin-bottom: 18px;
    }

    .shortcuts-section:last-child {
      margin-bottom: 0;
    }

    .shortcuts-section-title {
      font-size: 13px;
      color: var(--muted);
      font-weight: 600;
      margin-bottom: 10px;
    }

    .shortcuts-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px 16px;
    }

    .shortcut-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 10px 12px;
      border-radius: 12px;
      background: var(--day-other);
      border: 1px solid var(--border);
    }

    .shortcut-label {
      font-size: 14px;
      color: var(--text);
    }

    .shortcut-keys {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      direction: ltr;
    }

    .keycap {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 28px;
      padding: 4px 8px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--card);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      font-size: 12px;
      font-weight: 700;
      color: var(--text);
      text-transform: uppercase;
    }

    .keycap.wide {
      min-width: 44px;
    }

    .shortcut-note {
      font-size: 12px;
      color: var(--muted);
      margin-top: 12px;
    }


    /* Day Drawer/Popover */
    .day-drawer-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.4);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 250;
      padding: var(--space-4);
      backdrop-filter: blur(2px);
    }

    .day-drawer-backdrop.open {
      display: flex;
    }

    .day-drawer {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius-xl);
      width: 100%;
      max-width: 420px;
      max-height: 85vh;
      overflow: hidden;
      box-shadow: var(--shadow-hover);
      display: flex;
      flex-direction: column;
      direction: rtl;
      animation: drawerSlideIn 0.25s ease-out;
    }

    @keyframes drawerSlideIn {
      from {
        opacity: 0;
        transform: scale(0.95) translateY(10px);
      }

      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    .day-drawer-header {
      padding: var(--space-5);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: white;
    }

    .day-drawer-title {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-bold);
    }

    .day-drawer-subtitle {
      font-size: var(--font-size-sm);
      opacity: 0.9;
      margin-top: var(--space-1);
    }

    .day-drawer-close {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      font-size: var(--font-size-lg);
      cursor: pointer;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    .day-drawer-close:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .day-drawer-content {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-4);
    }

    .day-drawer-section {
      margin-bottom: var(--space-5);
    }

    .day-drawer-section:last-child {
      margin-bottom: 0;
    }

    .day-drawer-section-title {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-semibold);
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: var(--space-3);
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }

    .day-drawer-section-title .count {
      background: var(--accent);
      color: white;
      font-size: var(--font-size-xs);
      padding: 2px 8px;
      border-radius: 10px;
    }

    .day-drawer-empty {
      color: var(--muted);
      font-size: var(--font-size-sm);
      text-align: center;
      padding: var(--space-4);
      background: var(--day-other);
      border-radius: var(--radius-md);
    }

    .day-drawer-item {
      padding: var(--space-3);
      background: var(--day-other);
      border-radius: var(--radius-md);
      margin-bottom: var(--space-2);
      display: flex;
      align-items: center;
      gap: var(--space-3);
      cursor: pointer;
      transition: all 0.15s;
      border-right: 3px solid transparent;
    }

    .day-drawer-item:hover {
      background: var(--day-hover);
      border-right-color: var(--accent);
    }

    .day-drawer-item:last-child {
      margin-bottom: 0;
    }

    .day-drawer-item-color {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .day-drawer-item-info {
      flex: 1;
      min-width: 0;
    }

    .day-drawer-item-name {
      font-size: var(--font-size-base);
      font-weight: var(--font-weight-medium);
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .day-drawer-item-time {
      font-size: var(--font-size-xs);
      color: var(--muted);
      margin-top: 2px;
    }

    .day-drawer-item-priority {
      font-size: var(--font-size-xs);
      padding: 2px var(--space-2);
      border-radius: var(--radius-sm);
      font-weight: var(--font-weight-medium);
    }

    .day-drawer-item.task-completed .day-drawer-item-name {
      text-decoration: line-through;
      opacity: 0.6;
    }

    .day-drawer-actions {
      padding: var(--space-4);
      border-top: 1px solid var(--border);
      display: flex;
      gap: var(--space-2);
    }

    .day-drawer-actions .btn {
      flex: 1;
      padding: var(--space-3) var(--space-4);
      font-size: var(--font-size-sm);
    }

    /* Notes/Description */
    .input-row-notes {
      margin-top: 12px;
    }

    .input-row-notes textarea {
      width: 100%;
      padding: 12px 14px;
      border: 2px solid var(--border);
      border-radius: 10px;
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      min-height: 60px;
      max-height: 150px;
      outline: none;
      direction: rtl;
      text-align: right;
      background: var(--input-bg);
      color: var(--text);
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .input-row-notes textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
    }

    .event-notes {
      font-size: 12px;
      color: var(--muted);
      margin-top: 4px;
      white-space: pre-wrap;
      word-break: break-word;
      max-height: 40px;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .event-notes.expanded {
      max-height: none;
    }

    .notes-toggle {
      font-size: 11px;
      color: var(--accent);
      cursor: pointer;
      margin-top: 2px;
      display: inline-block;
    }

    .notes-toggle:hover {
      text-decoration: underline;
    }

    /* Task Manager Fullscreen Modal */
    .task-manager-overlay {
      position: fixed;
      top: 56px;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg);
      z-index: 300;
      display: none;
      flex-direction: column;
      overflow: hidden;
    }

    .task-manager-overlay.open {
      display: flex;
    }

    .task-manager-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-4) var(--space-6);
      background: var(--card);
      border-bottom: 1px solid var(--border);
      box-shadow: var(--shadow);
      gap: var(--space-4);
      flex-wrap: wrap;
    }

    .task-manager-title {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-bold);
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }

    .task-manager-close {
      width: 40px;
      height: 40px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--card);
      color: var(--text);
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .task-manager-close:hover {
      background: #fef2f2;
      color: var(--danger);
    }

    .task-search-bar {
      flex: 1;
      max-width: 500px;
      position: relative;
    }

    .task-search-bar input {
      width: 100%;
      padding: 12px 16px 12px 44px;
      border: 2px solid var(--border);
      border-radius: 10px;
      font-size: 15px;
      background: var(--input-bg);
      color: var(--text);
      outline: none;
      transition: all 0.2s;
    }

    .task-search-bar input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
    }

    .task-search-bar::before {
      content: '🔍';
      position: absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 16px;
    }

    .task-manager-body {
      flex: 1;
      overflow-y: auto;
      padding: 24px;
    }

    /* Quick Add Task */
    .quick-add-task {
      max-width: 600px;
      margin: 0 auto 32px auto;
      background: var(--card);
      border: 2px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      box-shadow: var(--shadow);
      transition: all 0.2s;
    }

    .quick-add-task:focus-within {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
    }

    .quick-add-task input[type="text"] {
      width: 100%;
      border: none;
      font-size: 16px;
      padding: 8px 0;
      background: transparent;
      color: var(--text);
      outline: none;
    }

    .quick-add-task input[type="text"]::placeholder {
      color: var(--muted);
    }

    .quick-add-row {
      display: flex;
      gap: 8px;
      margin-top: 12px;
      flex-wrap: wrap;
      align-items: center;
    }

    .quick-add-row .btn {
      padding: 10px 18px;
      font-size: 14px;
    }

    /* Color Picker */
    .color-picker {
      display: flex;
      gap: 6px;
    }

    .color-option {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      border: 3px solid transparent;
      cursor: pointer;
      transition: all 0.15s;
    }

    .color-option:hover {
      transform: scale(1.15);
    }

    .color-option.selected {
      border-color: var(--text);
      box-shadow: 0 0 0 2px var(--card);
    }

    /* Label/Tag Input */
    .label-input-wrapper {
      display: flex;
      align-items: center;
      gap: 6px;
      background: var(--day-other);
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 13px;
    }

    .label-input-wrapper input {
      border: none;
      background: transparent;
      font-size: 13px;
      width: 80px;
      color: var(--text);
      outline: none;
    }

    /* Task List */
    .task-sections {
      max-width: 900px;
      margin: 0 auto;
    }

    .task-section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--space-4);
      padding-left: var(--space-2);
    }

    .task-section-title {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-semibold);
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .task-sort-dropdown {
      position: relative;
    }

    .task-sort-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      font-size: 13px;
      color: var(--muted);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .task-sort-btn:hover {
      background: var(--hover);
      color: var(--text);
    }

    .task-sort-menu {
      position: absolute;
      top: 100%;
      right: 0;
      margin-top: 4px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-lg);
      z-index: 100;
      min-width: 180px;
      display: none;
    }

    .task-sort-menu.open {
      display: block;
    }

    .task-sort-option {
      padding: 10px 14px;
      font-size: 13px;
      color: var(--text);
      cursor: pointer;
      transition: background 0.15s ease;
    }

    .task-sort-option:hover {
      background: var(--hover);
    }

    .task-sort-option.selected {
      background: var(--primary-bg);
      color: var(--primary);
      font-weight: 500;
    }

    .task-sort-option:first-child {
      border-radius: var(--radius-md) var(--radius-md) 0 0;
    }

    .task-sort-option:last-child {
      border-radius: 0 0 var(--radius-md) var(--radius-md);
    }

    .task-list {
      display: flex;
      flex-direction: column;
      gap: var(--space-2);
      margin-bottom: var(--space-8);
    }

    /* Task Item (List style) */
    .task-item {
      background-color: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--space-4) var(--space-5);
      box-shadow: var(--shadow);
      transition: all 0.25s ease;
      display: flex;
      align-items: center;
      gap: var(--space-4);
      border-left: 5px solid var(--task-color, var(--priority-color, var(--border)));
      position: relative;
      overflow: visible;
    }

    /* Color accent overlay */
    .task-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, var(--task-color, transparent) 0%, transparent 100%);
      opacity: 0.08;
      pointer-events: none;
      border-radius: inherit;
    }

    /* Top accent stripe for colored tasks */
    .task-item::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--task-color, transparent);
      opacity: 0.6;
      border-radius: var(--radius-lg) var(--radius-lg) 0 0;
    }

    .task-item.dragging {
      opacity: 0.55;
      cursor: grabbing;
    }

    .task-item:hover {
      box-shadow: var(--shadow-hover);
      background-color: var(--priority-bg, var(--card));
    }

    .task-item.completed {
      opacity: 0.6;
      background-color: var(--day-other);
    }

    .task-checkbox {
      width: 24px;
      height: 24px;
      border: 2px solid var(--priority-color, var(--border));
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all 0.2s;
      background: transparent;
      color: transparent;
      font-size: var(--font-size-sm);
    }

    .task-checkbox:hover {
      background: var(--priority-bg, var(--day-hover));
    }

    .task-item.completed .task-checkbox {
      background: var(--priority-color, var(--success));
      border-color: var(--priority-color, var(--success));
      color: white;
    }

    .task-main {
      flex: 1;
      min-width: 0;
      cursor: pointer;
    }

    .task-title-row {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      margin-bottom: var(--space-1);
    }

    .task-title {
      font-size: var(--font-size-base);
      font-weight: var(--font-weight-semibold);
      color: var(--text);
      word-break: break-word;
    }

    .task-color-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      box-shadow: 0 0 0 2px var(--card), 0 2px 4px rgba(0, 0, 0, 0.15);
      flex-shrink: 0;
    }

    .task-item.completed .task-title {
      text-decoration: line-through;
      color: var(--muted);
    }

    .task-priority-badge {
      font-size: 10px;
      font-weight: var(--font-weight-bold);
      padding: 3px var(--space-2);
      border-radius: var(--radius-lg);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      background: var(--priority-color);
      color: white;
      flex-shrink: 0;
    }

    .task-meta {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      flex-wrap: wrap;
    }

    .task-due {
      font-size: var(--font-size-sm);
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: var(--space-1);
    }

    .task-due.overdue {
      color: var(--danger);
      font-weight: var(--font-weight-semibold);
    }

    .task-due.soon {
      color: #f97316;
      font-weight: var(--font-weight-semibold);
    }

    .task-countdown {
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-semibold);
      padding: var(--space-1) var(--space-2);
      border-radius: var(--radius-lg);
      background: var(--day-other);
      color: var(--text);
      font-variant-numeric: tabular-nums;
    }

    .task-countdown.overdue {
      background: #fef2f2;
      color: var(--danger);
    }

    .task-countdown.soon {
      background: #fff7ed;
      color: #f97316;
    }

    .task-recurrence {
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-semibold);
      padding: var(--space-1) var(--space-2);
      border-radius: var(--radius-lg);
      background: color-mix(in srgb, var(--accent) 14%, var(--day-other));
      color: var(--text);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    /* inline recurrence SVG uses its own inline styles; keep this as a harmless fallback */
    .recurrence-icon-svg {
      width: 13px;
      height: 13px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
    }

    .task-reminder {
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-semibold);
      padding: var(--space-1) var(--space-2);
      border-radius: var(--radius-lg);
      background: color-mix(in srgb, #f59e0b 14%, var(--day-other));
      color: var(--text);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .task-duration {
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-semibold);
      padding: var(--space-1) var(--space-2);
      border-radius: var(--radius-lg);
      background: color-mix(in srgb, #8b5cf6 14%, var(--day-other));
      color: var(--text);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .task-subtasks {
      margin-top: var(--space-2);
      padding-top: var(--space-2);
      border-top: 1px dashed var(--border);
    }

    .task-subtask {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 4px 0;
      font-size: 14px;
      color: var(--text);
    }

    .task-subtask input[type="checkbox"] {
      width: 16px;
      height: 16px;
      accent-color: var(--accent);
      cursor: pointer;
    }

    .task-subtask.checked span {
      text-decoration: line-through;
      color: var(--muted);
    }

    .task-subtask-progress {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .task-actions {
      display: flex;
      gap: 4px;
      flex-shrink: 0;
      overflow: visible;
    }

    .task-action-btn {
      width: 32px;
      height: 32px;
      border: none;
      background: transparent;
      color: var(--muted);
      font-size: 16px;
      cursor: pointer;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.15s;
    }

    .task-action-btn:hover {
      background: var(--day-hover);
      color: var(--text);
    }

    .task-action-btn.ai-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-size: 14px;
    }

    .task-action-btn.ai-btn:hover {
      background: linear-gradient(135deg, #5a6fd6 0%, #6a4190 100%);
      color: white;
      transform: scale(1.05);
    }

    .task-reminder-wrap {
      position: relative;
    }

    .task-reminder-btn {
      width: 32px;
      height: 32px;
      border: none;
      background: transparent;
      color: var(--muted);
      font-size: 16px;
      cursor: pointer;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.15s;
    }

    .task-reminder-btn:hover {
      background: #fef3c7;
      color: #f59e0b;
    }

    .task-reminder-btn.has-reminder {
      color: #f59e0b;
      background: rgba(245, 158, 11, 0.1);
    }

    .task-reminder-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 10px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      padding: 8px;
      display: none;
      z-index: 100;
      min-width: 140px;
      margin-top: 4px;
    }

    .task-reminder-dropdown.open {
      display: block;
    }

    .task-reminder-option {
      padding: 8px 12px;
      font-size: 13px;
      color: var(--text);
      cursor: pointer;
      border-radius: 6px;
      transition: background 0.15s;
      white-space: nowrap;
    }

    .task-reminder-option:hover {
      background: var(--day-hover);
    }

    .task-reminder-option.active {
      background: rgba(102, 126, 234, 0.1);
      color: var(--accent);
    }

    .task-reminder-option.remove {
      color: #ef4444;
    }

    .task-action-btn.delete:hover {
      background: #fef2f2;
      color: var(--danger);
    }

    /* Task Edit Modal */
    .task-edit-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 400;
      padding: 20px;
    }

    .task-edit-modal.open {
      display: flex;
    }

    .task-edit-card {
      background: var(--card);
      border-radius: 16px;
      padding: 24px;
      max-width: 600px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .task-edit-card input[type="text"],
    .task-edit-card textarea {
      width: 100%;
      border: none;
      background: transparent;
      color: var(--text);
      outline: none;
      resize: none;
    }

    .task-edit-card input[type="text"] {
      font-size: 20px;
      font-weight: 600;
      padding: 8px 0;
    }

    .task-edit-card textarea {
      font-size: 15px;
      line-height: 1.6;
      min-height: 150px;
      margin-top: 16px;
    }

    .task-edit-section {
      margin-top: 20px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
    }

    .task-edit-section-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--muted);
      margin-bottom: 12px;
    }

    .checklist-add {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 12px;
    }

    .checklist-add input {
      flex: 1;
      padding: 10px 14px;
      border: 2px solid var(--border);
      border-radius: 8px;
      font-size: 14px;
      background: var(--input-bg);
      color: var(--text);
      outline: none;
    }

    .checklist-add input:focus {
      border-color: var(--accent);
    }

    .task-edit-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 24px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
      flex-wrap: wrap;
      gap: 12px;
    }

    /* Empty Tasks State */
    .tasks-empty {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
    }

    .tasks-empty-icon {
      font-size: 64px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .tasks-empty h3 {
      font-size: 20px;
      color: var(--text);
      margin-bottom: 8px;
    }

    .tasks-empty p {
      font-size: 14px;
    }

    /* Suggested Tasks Banner */
    .suggested-tasks-banner {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      border: 1px solid var(--accent);
      border-radius: 10px;
      padding: 12px 16px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 13px;
      color: var(--text);
    }

    .suggested-tasks-banner .suggested-icon {
      font-size: 18px;
    }

    /* Task Subject Tag (when showing suggested) */
    .task-subject-tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: rgba(102, 126, 234, 0.15);
      color: var(--accent);
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 11px;
      margin-left: 8px;
    }

    .task-subject-tag .tag-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
    }

    /* Filter Pills */
    .task-filters {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .filter-pill {
      padding: 8px 16px;
      border: 1px solid var(--border);
      border-radius: 20px;
      background: var(--card);
      color: var(--muted);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
    }

    .filter-pill:hover {
      background: var(--day-hover);
    }

    .filter-pill.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    /* Priority Selector */
    .priority-selector {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .priority-option {
      padding: 8px 16px;
      border: 2px solid transparent;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
    }

    .priority-option:hover {
      transform: scale(1.05);
    }

    .priority-option.selected {
      border-color: var(--text);
    }

    .priority-option[data-priority="urgent"] {
      background: #fef2f2;
      color: #ef4444;
    }

    .priority-option[data-priority="high"] {
      background: #fff7ed;
      color: #f97316;
    }

    .priority-option[data-priority="medium"] {
      background: #fefce8;
      color: #eab308;
    }

    .priority-option[data-priority="low"] {
      background: #f0fdf4;
      color: #22c55e;
    }

    .priority-option[data-priority="none"] {
      background: var(--day-other);
      color: var(--muted);
    }

    /* Task Checklist in Edit Modal */
    .task-checklist {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .task-checklist-item {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
      padding: 8px 0;
    }

    .task-checklist-item input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: var(--accent);
      cursor: pointer;
    }

    .task-checklist-item.checked span {
      text-decoration: line-through;
      color: var(--muted);
    }

    .task-color-picker {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      align-items: center;
      padding: 8px;
      background: var(--day-other);
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
    }

    .task-color-picker.compact {
      gap: 5px;
      padding: 6px 8px;
      background: transparent;
      border: none;
    }

    .task-color-option {
      width: 24px;
      height: 24px;
      border-radius: 6px;
      border: 2px solid transparent;
      cursor: pointer;
      transition: all 0.15s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: 600;
      color: var(--muted);
      background: var(--day-other);
      position: relative;
    }

    .task-color-option.subject {
      font-weight: 700;
      color: #fff;
      border-style: dashed;
      border-color: var(--border);
    }

    .task-color-option.disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .task-color-picker.compact .task-color-option {
      width: 20px;
      height: 20px;
      font-size: 9px;
      border-radius: 5px;
    }

    .task-color-option.none {
      color: var(--muted);
      background: var(--card);
      border: 2px dashed var(--border);
      font-size: 12px;
    }

    .task-color-option:not(.disabled):hover {
      transform: scale(1.15);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }

    .task-color-option.selected {
      border-color: var(--text);
      box-shadow: 0 0 0 2px var(--card), 0 2px 8px rgba(0, 0, 0, 0.2);
      transform: scale(1.1);
    }

    .task-color-option.selected.none {
      border-style: solid;
      border-color: var(--accent);
      background: var(--card);
    }


    .subject-tab {
      padding: 8px 16px;
      border: 2px solid var(--border);
      border-radius: 20px;
      background: var(--card);
      color: var(--muted);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 6px;
      position: relative;
    }

    .subject-tab:hover {
      background: var(--day-hover);
      border-color: var(--accent);
    }

    .subject-tab.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    .subject-tab.smart-view {
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: white;
      border: none;
    }

    .subject-tab.smart-view:not(.active) {
      background: var(--day-other);
      color: var(--muted);
    }

    .subject-tab .tab-count {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.25);
      min-width: 18px;
      text-align: center;
    }

    .subject-tab:not(.active) .tab-count {
      background: var(--day-other);
      color: var(--muted);
    }

    .subject-tab .tab-color,
    .subject-tab-color {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    /* Smart Views Section */
    .smart-views-section {
      display: flex;
      gap: 6px;
      padding-right: 12px;
      border-right: 1px solid var(--border);
      margin-right: 4px;
    }

    /* Subject with sub-subjects */
    .subject-tab.has-children .subject-tab-inner {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .subject-tab .expand-arrow {
      font-size: 8px;
      transition: transform 0.2s;
      opacity: 0.7;
    }

    .subject-tab.expanded .expand-arrow {
      transform: rotate(180deg);
    }

    /* Sub-subjects list (inline chips) */
    .sub-subjects-inline {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
      margin-left: 4px;
      padding-left: 8px;
      border-left: 2px solid var(--border);
    }

    .sub-subject-chip {
      padding: 4px 10px;
      border-radius: 12px;
      background: var(--day-other);
      color: var(--text);
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      transition: all 0.15s;
    }

    .sub-subject-chip:hover {
      background: var(--day-hover);
    }

    .sub-subject-chip.active {
      background: var(--accent);
      color: white;
    }

    .sub-subject-chip .chip-color {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }



    /* -------------------- Subjects / Sidebar -------------------- */
    .add-subject-btn {
      width: 36px;
      height: 36px;
      border: 2px dashed var(--border);
      border-radius: 50%;
      background: transparent;
      color: var(--muted);
      font-size: 20px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .add-subject-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
      background: rgba(102, 126, 234, 0.1);
    }

    /* Task Calendar in Sidebar - matches countdown calendar style */
    .task-calendar-section {
      margin-top: 20px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
    }



    .task-calendar-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
      gap: 10px;
    }

    .task-calendar-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text);
    }

    .task-calendar-nav {
      display: flex;
      gap: 8px;
    }



    .task-manager-sidebar {
      width: 260px;
      min-width: 200px;
      background: var(--card);
      border-left: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .task-manager-sidebar-header {
      padding: 16px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .task-manager-sidebar-header h3 {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin: 0;
    }

    .task-manager-sidebar-content {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
    }

    /* Collapsible Subject List */
    .subject-list-item {
      margin-bottom: 4px;
    }

    .subjects-list {
      overflow-x: auto;
      overflow-y: visible;
    }

    .subject-list-header {
      display: flex;
      align-items: center;
      padding: 10px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.15s;
      gap: 8px;
      position: relative;
    }

    .subject-list-header:hover {
      background: var(--day-hover);
    }

    /* Custom tooltip for subject names */
    .subject-list-header[title]:hover::after,
    .subject-child-item[title]:hover::after {
      content: attr(title);
      position: absolute;
      bottom: 100%;
      left: 12px;
      right: auto;
      background: var(--text);
      color: var(--bg);
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
      white-space: nowrap;
      z-index: 1001;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      pointer-events: none;
      animation: tooltipFade 0.2s ease;
      margin-bottom: 4px;
    }

    @keyframes tooltipFade {
      from {
        opacity: 0;
        transform: translateY(4px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .subject-list-header:hover .subject-actions {
      opacity: 1;
    }

    /* Subject Action Buttons */
    .subject-actions {
      display: flex;
      gap: 4px;
      opacity: 0;
      transition: opacity 0.2s;
      margin-right: auto;
      flex-shrink: 0;
    }

    .subject-action-btn {
      width: 28px;
      height: 28px;
      border: 1px solid transparent;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      color: var(--text);
      opacity: 0.8;
    }

    body.dark .subject-action-btn {
      background: rgba(255, 255, 255, 0.1);
    }

    .subject-action-btn:hover {
      background: rgba(0, 0, 0, 0.15);
      opacity: 1;
      transform: scale(1.1);
      border-color: var(--border);
    }

    body.dark .subject-action-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .subject-list-header.active .subject-action-btn {
      background: rgba(255, 255, 255, 0.15);
      color: white;
    }

    .subject-list-header.active .subject-action-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .subject-action-btn.delete:hover {
      background: rgba(239, 68, 68, 0.15);
      color: var(--danger);
      border-color: var(--danger);
    }

    .subject-child-item .subject-action-btn {
      width: 26px;
      height: 26px;
      font-size: 13px;
    }

    .subject-child-item:hover .subject-actions {
      opacity: 1;
    }

    .subject-list-header.active {
      background: var(--accent);
      color: white;
    }

    .subject-list-header.drag-over,
    .subject-child-item.drag-over {
      outline: 2px dashed var(--accent);
      background: var(--day-hover);
    }

    .subject-list-header .subject-color-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .subject-list-header .subject-name {
      flex: 1;
      font-size: 13px;
      font-weight: 500;
      white-space: nowrap;
      min-width: 0;
    }

    .subject-list-header .subject-count {
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 8px;
      background: rgba(0, 0, 0, 0.1);
      color: inherit;
      flex-shrink: 0;
    }

    .subject-list-header.active .subject-count {
      background: rgba(255, 255, 255, 0.2);
    }

    .subject-list-header .collapse-arrow {
      font-size: 10px;
      transition: transform 0.25s ease;
      opacity: 0.6;
      cursor: pointer;
      flex-shrink: 0;
    }

    .subject-list-header .collapse-arrow:hover {
      opacity: 1;
    }

    .subject-list-item.expanded .collapse-arrow {
      transform: rotate(180deg);
    }

    /* Shared subject indicator */
    .shared-badge {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 6px;
      background: rgba(102, 126, 234, 0.15);
      color: var(--accent);
      margin-right: 4px;
      display: inline-flex;
      align-items: center;
      gap: 3px;
      flex-shrink: 0;
      position: relative;
      z-index: 1;
    }

    .shared-badge svg {
      width: 10px;
      height: 10px;
    }

    .subject-list-header.active .shared-badge {
      background: rgba(255, 255, 255, 0.2);
      color: inherit;
    }

    /* Shared users pills in modal */
    .shared-user-pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 10px;
      background: var(--accent);
      color: white;
      border-radius: 16px;
      font-size: 12px;
      margin: 2px;
    }

    .shared-user-pill .remove-share {
      cursor: pointer;
      opacity: 0.8;
      margin-right: -4px;
      padding: 2px;
    }

    .shared-user-pill .remove-share:hover {
      opacity: 1;
    }

    .shared-user-pill.owner {
      background: var(--muted);
    }

    .subject-list-children {
      padding-right: 20px;
      margin-top: 0;
      overflow: hidden;
      max-height: 0;
      opacity: 0;
      transition: max-height 0.3s ease, opacity 0.25s ease, margin-top 0.25s ease;
    }

    .subject-list-item.expanded .subject-list-children {
      max-height: 500px;
      /* Large enough for many children */
      opacity: 1;
      margin-top: 4px;
    }

    .subject-child-item {
      display: flex;
      align-items: center;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      gap: 8px;
      margin-bottom: 2px;
      transform: translateX(0);
      position: relative;
    }

    .subject-child-item:hover {
      background: var(--day-hover);
      transform: translateX(-2px);
    }

    .subject-child-item.active {
      background: var(--accent);
      color: white;
    }

    .subject-child-item .child-color {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .subject-child-item .child-name {
      flex: 1;
      font-size: 12px;
      white-space: nowrap;
      min-width: 0;
    }

    .subject-child-item .child-count {
      font-size: 10px;
      opacity: 0.7;
      flex-shrink: 0;
    }

    /* Smart Views in Sidebar */
    .smart-views-list {
      margin-bottom: 16px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border);
    }

    .smart-view-item {
      display: flex;
      align-items: center;
      padding: 10px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.15s;
      gap: 8px;
      margin-bottom: 2px;
    }

    .smart-view-item:hover {
      background: var(--day-hover);
    }

    .smart-view-item.active {
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: white;
    }

    .smart-view-item .view-icon {
      font-size: 14px;
    }

    .smart-view-item .view-name {
      flex: 1;
      font-size: 13px;
      font-weight: 500;
    }

    .smart-view-item .view-count {
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 8px;
      background: rgba(0, 0, 0, 0.1);
    }

    .smart-view-item.active .view-count {
      background: rgba(255, 255, 255, 0.2);
    }

    .subjects-list-title {
      font-size: 11px;
      font-weight: 600;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 8px 12px 4px;
    }

    /* Add Subject Button in Sidebar */
    .add-subject-sidebar-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border: 2px dashed var(--border);
      border-radius: 8px;
      background: transparent;
      color: var(--muted);
      font-size: 13px;
      cursor: pointer;
      transition: all 0.15s;
      width: 100%;
      margin-top: 8px;
    }

    .add-subject-sidebar-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
      background: rgba(102, 126, 234, 0.05);
    }

    /* Task Month List */
    .task-month-section {
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
    }

    .task-month-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 10px;
    }

    .task-month-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      max-height: none;
      overflow: visible;
    }

    .task-month-item {
      padding: 8px 10px;
      background: var(--day-other);
      border-radius: 6px;
      border-right: 3px solid var(--accent);
      font-size: 12px;
    }

    .task-month-item-title {
      font-weight: 500;
      color: var(--text);
      margin-bottom: 2px;
    }

    .task-month-item-date {
      font-size: 10px;
      color: var(--muted);
    }

    /* Context Menu */
    .context-menu {
      position: fixed;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
      padding: 8px;
      min-width: 180px;
      z-index: 1000;
      display: none;
    }

    .context-menu.open {
      display: block;
    }

    .context-menu-item {
      padding: 10px 14px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--text);
      font-size: 13px;
      transition: background 0.1s;
    }

    .context-menu-item:hover {
      background: var(--day-hover);
    }

    .context-menu-item.danger {
      color: var(--danger);
    }

    .context-menu-item.danger:hover {
      background: #fef2f2;
    }

    .context-menu-divider {
      height: 1px;
      background: var(--border);
      margin: 6px 0;
    }

    /* Daily Reminder Modal */
    .reminder-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      /* Must sit above full-screen overlays (Planner/Task/Pomodoro) and the fixed header bar */
      z-index: 15000;
      padding: 20px;
    }

    .reminder-modal.open {
      display: flex;
    }

    .reminder-card {
      background: var(--card);
      border-radius: 20px;
      padding: 28px;
      max-width: 500px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      text-align: center;
    }

    #eventAlertModal .reminder-card {
      background: linear-gradient(180deg, rgba(102, 126, 234, 0.12), var(--card));
      border: 1px solid rgba(102, 126, 234, 0.2);
      animation: alertPop 0.25s ease-out;
    }

    @keyframes alertPop {
      from {
        opacity: 0;
        transform: translateY(8px) scale(0.98);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .reminder-card h2 {
      font-size: 24px;
      margin-bottom: 8px;
      color: var(--text);
    }

    .reminder-card .reminder-date {
      color: var(--muted);
      font-size: 14px;
      margin-bottom: 20px;
    }

    /* Calendar Sync: Google settings panel */
    .calendar-sync-settings {
      margin: 12px 0 16px;
      text-align: left;
      border: 1px solid var(--border);
      border-radius: 14px;
      background: var(--day-other);
      padding: 12px 12px;
    }

    .calendar-sync-settings summary {
      cursor: pointer;
      font-weight: 650;
      color: var(--text);
      user-select: none;
    }

    .calendar-sync-settings summary::-webkit-details-marker {
      display: none;
    }

    .calendar-sync-settings .settings-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
    }

    .calendar-sync-settings label {
      font-size: 12px;
      color: var(--muted);
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .calendar-sync-settings input {
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: var(--input-bg);
      color: var(--text);
      font-size: 13px;
      outline: none;
    }

    .calendar-sync-settings input:focus {
      border-color: var(--accent);
      box-shadow: var(--focus-ring);
    }

    .calendar-sync-settings .settings-actions {
      display: flex;
      gap: 8px;
      margin-top: 2px;
    }

    .calendar-sync-settings .settings-hint {
      margin-top: 10px;
      font-size: 11px;
      color: var(--muted);
      line-height: 1.35;
    }

    .reminder-section {
      text-align: right;
      margin-bottom: 16px;
    }

    .reminder-section h3 {
      font-size: 14px;
      color: var(--accent);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .reminder-task-item {
      padding: 12px;
      background: var(--day-other);
      border-radius: 10px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
      text-align: right;
    }

    .reminder-task-item .task-priority-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .reminder-task-item .task-info {
      flex: 1;
    }

    .reminder-task-item .task-title {
      font-weight: 600;
      color: var(--text);
      font-size: 14px;
    }

    .reminder-task-item .task-time {
      font-size: 12px;
      color: var(--muted);
    }

    .reminder-empty {
      color: var(--muted);
      font-size: 14px;
      padding: 12px;
    }

    .reminder-actions {
      margin-top: 20px;
    }

    /* Natural Language Input Hint */
    .nl-hint {
      font-size: 12px;
      color: var(--muted);
      margin-top: 8px;
      direction: rtl;
      line-height: 1.6;
    }

    .nl-hint code {
      background: var(--day-other);
      padding: 2px 6px;
      border-radius: 4px;
      font-family: inherit;
      color: var(--accent);
      font-weight: 500;
    }

    .nl-hint-toggle {
      color: var(--accent);
      cursor: pointer;
      text-decoration: underline;
      margin-right: 8px;
    }

    .nl-hint-examples {
      display: none;
      margin-top: 12px;
      padding: 16px;
      background: var(--day-other);
      border-radius: 10px;
      font-size: 12px;
      max-height: 400px;
      overflow-y: auto;
      direction: rtl;
    }

    .nl-hint-examples.show {
      display: block;
    }

    .nl-hint-examples div {
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border);
    }

    .nl-hint-examples div:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    .nl-hint-examples .example-input {
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
      padding: 6px 10px;
      background: var(--card);
      border-radius: 6px;
      border-right: 3px solid var(--accent);
    }

    .nl-hint-examples .example-result {
      color: var(--muted);
      font-size: 11px;
      padding-right: 16px;
    }



    /* (duplicate .add-subject-btn removed) */



    .task-calendar-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
      gap: 10px;
    }

    .task-calendar-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text);
    }

    .task-calendar-nav {
      display: flex;
      gap: 8px;
    }



    /* Subject Modal */
    .subject-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 500;
      padding: 20px;
    }

    .subject-modal.open {
      display: flex;
    }

    .subject-modal-card {
      background: var(--card);
      border-radius: 16px;
      padding: 24px;
      max-width: 400px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .subject-modal-card h3 {
      font-size: 20px;
      margin-bottom: 20px;
      color: var(--text);
    }

    .subject-modal-card input {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid var(--border);
      border-radius: 10px;
      font-size: 15px;
      background: var(--input-bg);
      color: var(--text);
      outline: none;
      margin-bottom: 16px;
    }

    .subject-modal-card input:focus {
      border-color: var(--accent);
    }

    .subject-color-picker {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    .subject-color-option {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 3px solid transparent;
      cursor: pointer;
      transition: all 0.15s;
    }

    .subject-color-option:hover {
      transform: scale(1.15);
    }

    .subject-color-option.selected {
      border-color: var(--text);
      box-shadow: 0 0 0 2px var(--card);
    }

    .subject-modal-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    .subject-modal-actions .btn {
      padding: 12px 20px;
    }

    /* Subject badge in task item */
    .task-subject-badge {
      font-size: 11px;
      font-weight: 600;
      padding: 3px 10px;
      border-radius: 12px;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 6px;
      background: color-mix(in srgb, var(--subject-color, #667eea) 28%, transparent);
      color: var(--subject-color, #667eea);
      border: 1px solid color-mix(in srgb, var(--subject-color, #667eea) 45%, transparent);
      box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--subject-color, #667eea) 12%, transparent);
    }

    .task-subject-badge::before {
      content: '';
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--subject-color, #667eea);
      flex-shrink: 0;
    }

    .task-subject-badge .badge-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }

    /* Subject selector in quick add */
    .subject-selector {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .subject-selector-option {
      padding: 6px 14px;
      border: 2px solid var(--border);
      border-radius: 16px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .subject-selector-option:hover {
      border-color: var(--accent);
    }

    .subject-selector-option.selected {
      border-color: var(--text);
      background: var(--day-hover);
    }

    .subject-selector-option .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }

    /* Edit subject button */
    .edit-subject-btn {
      padding: 4px 8px;
      border: none;
      background: transparent;
      color: var(--muted);
      font-size: 12px;
      cursor: pointer;
      border-radius: 4px;
      margin-left: 4px;
    }

    .edit-subject-btn:hover {
      background: var(--day-hover);
      color: var(--text);
    }

    /* Notification permission button */
    @media (max-width: 1100px) {
      .sidebar {
        position: relative;
        box-shadow: none;
      }

      .sidebar.hidden {
        transform: translateX(100%);
      }

      /* Fix for Task Manager Calendar Sidebar visibility */
      #taskRightSidebar {
        z-index: 350;
        /* Must be higher than task-manager-overlay (300) */
      }

      #taskRightSidebar.calendar-expanded {
        width: 100%;
        min-width: 0;
      }

      @media (max-width: 1100px) {
        #taskRightSidebar {
          position: absolute;
          /* Override fixed positioning from generic .sidebar */
          height: 100%;
        }
      }
    }


    /* Bad Day Presets - special styling */
    .pomodoro-preset.bad-day {
      border-color: rgba(249, 115, 22, 0.3);
      background: linear-gradient(135deg, rgba(249, 115, 22, 0.05), rgba(234, 179, 8, 0.05));
      color: #f97316;
    }

    .pomodoro-preset.bad-day:hover {
      border-color: #f97316;
      background: linear-gradient(135deg, rgba(249, 115, 22, 0.1), rgba(234, 179, 8, 0.1));
      color: #ea580c;
    }

    .pomodoro-preset.bad-day.active {
      background: linear-gradient(135deg, #f97316, #eab308);
      border-color: transparent;
      color: white;
      box-shadow: 0 4px 16px rgba(249, 115, 22, 0.4);
    }

    /* Bad Day Tip */
    .pomodoro-bad-day-tip {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 16px 20px;
      background: linear-gradient(135deg, rgba(249, 115, 22, 0.08), rgba(234, 179, 8, 0.08));
      border: 1px solid rgba(249, 115, 22, 0.2);
      border-radius: 16px;
      width: 100%;
      max-width: 500px;
      animation: tipFadeIn 0.4s ease;
    }

    @keyframes tipFadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .pomodoro-bad-day-tip .tip-icon {
      font-size: 20px;
      flex-shrink: 0;
    }

    .pomodoro-bad-day-tip .tip-text {
      font-size: 13px;
      line-height: 1.6;
      color: var(--text);
      opacity: 0.85;
    }

    /* Pomodoro RTL tweaks */
    .pomodoro-overlay {
      direction: rtl;
    }

    .pomodoro-card,
    .pomodoro-options,
    .pomodoro-settings-panel,
    .pomodoro-presets,
    .pomodoro-daily,
    .pomodoro-stats,
    .pomodoro-task-select,
    .pomodoro-mini {
      text-align: right;
    }

    .pomodoro-mini {
      direction: rtl;
    }

    .pomodoro-time,
    .pomodoro-mini-time {
      direction: ltr;
      text-align: center;
    }

    .pomodoro-next,
    .pomodoro-mode,
    .pomodoro-mini-mode {
      text-align: center;
    }

    .pomodoro-controls,
    .pomodoro-presets,
    .pomodoro-options,
    .pomodoro-settings-panel,
    .pomodoro-stats,
    .pomodoro-daily {
      direction: rtl;
    }

    /* ==========================================================================
       MOBILE & ANDROID PWA REDESIGN
       Extensive customization for touch-based mobile usage
       Does NOT affect macOS/desktop web experience
       ========================================================================== */

    /* Mobile detection: smartphones and PWA standalone mode */

    /* Quick Date Options */
    .quick-date-options {
      display: flex;
      gap: 8px;
      margin-top: 8px;
      flex-wrap: wrap;
    }

    .quick-date-btn {
      padding: 6px 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--bg-secondary);
      color: var(--text);
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .quick-date-btn:hover {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    /* ==========================================================================
       ENHANCED MOBILE GESTURES & INTERACTIONS
       Swipe actions, touch ripples, haptic feedback, smooth transitions
       ========================================================================== */

    /* Mobile only - swipe and gesture enhancements */

    /* Reduce motion for users who prefer it */
    @media (prefers-reduced-motion: reduce) {

      .swipe-container .task-item,
      .swipe-container .event-row,
      .task-item,
      .event-row,
      .mobile-bottom-sheet,
      .mobile-toast,
      .view-container {
        animation: none !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* ===== Quick Reminder Buttons Base Styles ===== */
    .quick-reminder-btns {
      display: flex;
      gap: 8px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    .quick-reminder-btn {
      padding: 6px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--btn-secondary-bg);
      color: var(--text);
      font-size: 12px;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .quick-reminder-btn:hover {
      background: var(--btn-secondary-hover);
      border-color: var(--accent);
    }

    .quick-reminder-btn:active {
      transform: scale(0.95);
    }